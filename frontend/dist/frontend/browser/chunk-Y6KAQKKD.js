import{a as ot,b as rt,c as st,d as ct,e as lt,g as mt}from"./chunk-YRLYPSZF.js";import{e as be,f as ut,g as xe,h as Me,i as ve,j as Pe,k as Oe,l as Se,m as ye,n as ht,r as _t}from"./chunk-DMRAWTGL.js";import{a as fe,b as Ce}from"./chunk-YRZUBIO5.js";import{$ as He,A as Ne,Ab as F,Bb as K,Ca as t,Da as n,Ea as h,F as H,Fa as te,G as $e,Ga as ne,Ia as O,J as Y,Jb as ce,Ka as _,La as d,Lb as le,M as Re,Md as gt,N as A,Od as pt,P as V,S as Ge,Sd as _e,T as x,Ta as r,U as M,Ua as b,V as C,Va as E,W as v,Wa as Ue,Xa as se,Ya as ie,Za as ae,_a as oe,ab as L,c as re,cc as Xe,d as z,dc as me,fc as ze,ga as s,gb as P,ha as k,hb as S,hc as de,i as G,ib as Te,k as j,kc as Ae,l as Le,lc as ge,m as Ie,mb as Ye,nc as Qe,nd as J,oc as et,od as dt,pd as N,qc as tt,qd as Z,ra as g,rb as We,rc as nt,rd as $,sb as qe,sd as ue,ta as l,tb as W,tc as it,td as he,ub as q,uc as pe,v as D,va as T,vc as at,w as ke,wa as Be,wb as Ke,x as Fe,yb as Je,zb as Ze}from"./chunk-D537H2LC.js";import{a as Ee,b as Ve,f as R}from"./chunk-CWTPBX7D.js";var bt=(()=>{class i{constructor(){this.STORAGE_KEY_PREFIX="campaign_form_"}getStorageKey(e,o,a){return`${this.STORAGE_KEY_PREFIX}${e}_${o}_${a}`}saveCampaignData(e,o,a,c){try{let p=this.getStorageKey(e,o,a),u=this.getCampaignData(e,o,a),f=Ve(Ee(Ee({},u),c),{templateId:e,runId:o,variantNo:a,savedAt:new Date().toISOString()});localStorage.setItem(p,JSON.stringify(f))}catch{}}getCampaignData(e,o,a){try{let c=this.getStorageKey(e,o,a),p=localStorage.getItem(c);if(p)return JSON.parse(p)}catch{}return this.getEmptyFormData(e,o,a)}hasCampaignData(e,o,a){try{let c=this.getStorageKey(e,o,a);return localStorage.getItem(c)!==null}catch{return!1}}clearCampaignData(e,o,a){try{let c=this.getStorageKey(e,o,a);localStorage.removeItem(c)}catch{}}clearAllCampaignData(){try{let e=[];for(let o=0;o<localStorage.length;o++){let a=localStorage.key(o);a&&a.startsWith(this.STORAGE_KEY_PREFIX)&&e.push(a)}e.forEach(o=>localStorage.removeItem(o))}catch{}}getEmptyFormData(e,o,a){return{selectedAudience:null,masterData:[],uploadedFileName:"",reconciliation:null,addNewMembersToAudience:!1,scheduleGroups:[],timezoneAnalysis:null,subject:"",bodyAddition:"",generatedSubjects:[],testEmails:[],testEmailSent:!1,testEmailSentAt:null,templateId:e,runId:o,variantNo:a,savedAt:new Date().toISOString()}}static{this.\u0275fac=function(o){return new(o||i)}}static{this.\u0275prov=Y({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();function Et(i,m){if(i&1&&(t(0,"span",20),r(1),n()),i&2){let e=d(2);s(),b(e.hourError)}}function It(i,m){if(i&1&&(t(0,"span",20),r(1),n()),i&2){let e=d(2);s(),b(e.minuteError)}}function kt(i,m){if(i&1&&(t(0,"div",21)(1,"mat-icon"),r(2,"schedule"),n(),t(3,"span"),r(4),n()()),i&2){let e=d(2);s(4),b(e.getFormattedTime())}}function Tt(i,m){if(i&1){let e=O();t(0,"div",11)(1,"h3")(2,"mat-icon"),r(3,"access_time"),n(),r(4," Enter Time "),n(),t(5,"div",12)(6,"div",13)(7,"label"),r(8,"Hour"),n(),t(9,"input",14),oe("ngModelChange",function(a){x(e);let c=d();return ae(c.hourInput,a)||(c.hourInput=a),M(a)}),_("input",function(){x(e);let a=d();return M(a.validateHour())})("blur",function(){x(e);let a=d();return M(a.formatHour())}),n(),t(10,"span",15),r(11,"0-23"),n(),g(12,Et,2,1,"span",16),n(),t(13,"span",17),r(14,":"),n(),t(15,"div",13)(16,"label"),r(17,"Minute"),n(),t(18,"input",18),oe("ngModelChange",function(a){x(e);let c=d();return ae(c.minuteInput,a)||(c.minuteInput=a),M(a)}),_("input",function(){x(e);let a=d();return M(a.validateMinute())})("blur",function(){x(e);let a=d();return M(a.formatMinute())}),n(),t(19,"span",15),r(20,"0-59"),n(),g(21,It,2,1,"span",16),n()(),g(22,kt,5,1,"div",19),n()}if(i&2){let e=d();s(9),T("error",e.hourError),ie("ngModel",e.hourInput),s(3),l("ngIf",e.hourError),s(6),T("error",e.minuteError),ie("ngModel",e.minuteInput),s(3),l("ngIf",e.minuteError),s(),l("ngIf",e.isTimeValid())}}function zt(i,m){if(i&1){let e=O();t(0,"div",24),_("click",function(){let a=x(e).$implicit,c=d(2);return M(c.selectTimezone(a.value))}),t(1,"mat-icon"),r(2,"language"),n(),t(3,"div",25)(4,"span",26),r(5),n()()()}if(i&2){let e=m.$implicit,o=d(2);T("selected",o.selectedTimezone===e.value),s(5),b(e.label)}}function At(i,m){if(i&1){let e=O();t(0,"div",22)(1,"h3")(2,"mat-icon"),r(3,"public"),n(),r(4," Select Timezone (Optional) "),n(),t(5,"div",23)(6,"div",24),_("click",function(){x(e);let a=d();return M(a.selectTimezone(""))}),t(7,"mat-icon"),r(8,"my_location"),n(),t(9,"div",25)(10,"span",26),r(11,"Local Time"),n(),t(12,"span",27),r(13,"Your timezone"),n()()(),g(14,zt,6,3,"div",28),n()()}if(i&2){let e=d();s(6),T("selected",e.selectedTimezone===""),s(8),l("ngForOf",e.timezones)}}var je=(()=>{class i{constructor(e,o){this.dialogRef=e,this.data=o,this.sendImmediately=!0,this.hourInput=9,this.minuteInput=0,this.selectedTimezone="",this.hourError="",this.minuteError="",this.timezones=[{value:"America/New_York",label:"Eastern Time (ET)"},{value:"America/Chicago",label:"Central Time (CT)"},{value:"America/Denver",label:"Mountain Time (MT)"},{value:"America/Los_Angeles",label:"Pacific Time (PT)"},{value:"America/Anchorage",label:"Alaska (AKST)"},{value:"Pacific/Honolulu",label:"Hawaii (HST)"},{value:"America/Halifax",label:"Atlantic Time (AST)"},{value:"America/Sao_Paulo",label:"Brazil (BRT)"},{value:"America/Argentina/Buenos_Aires",label:"Argentina (ART)"},{value:"America/Santiago",label:"Chile (CLT)"},{value:"America/Mexico_City",label:"Mexico City (CST)"},{value:"Europe/London",label:"London (GMT)"},{value:"Europe/Paris",label:"Paris (CET)"},{value:"Europe/Berlin",label:"Berlin (CET)"},{value:"Europe/Madrid",label:"Madrid (CET)"},{value:"Europe/Rome",label:"Rome (CET)"},{value:"Europe/Amsterdam",label:"Amsterdam (CET)"},{value:"Europe/Athens",label:"Athens (EET)"},{value:"Europe/Moscow",label:"Moscow (MSK)"},{value:"Europe/Istanbul",label:"Istanbul (TRT)"},{value:"Asia/Dubai",label:"Dubai (GST)"},{value:"Asia/Jerusalem",label:"Israel (IST)"},{value:"Asia/Riyadh",label:"Saudi Arabia (AST)"},{value:"Asia/Kolkata",label:"India (IST)"},{value:"Asia/Singapore",label:"Singapore (SGT)"},{value:"Asia/Tokyo",label:"Tokyo (JST)"},{value:"Asia/Seoul",label:"Seoul (KST)"},{value:"Asia/Shanghai",label:"Shanghai (CST)"},{value:"Asia/Hong_Kong",label:"Hong Kong (HKT)"},{value:"Asia/Bangkok",label:"Bangkok (ICT)"},{value:"Asia/Jakarta",label:"Jakarta (WIB)"},{value:"Asia/Manila",label:"Manila (PHT)"},{value:"Asia/Karachi",label:"Karachi (PKT)"},{value:"Australia/Sydney",label:"Sydney (AEDT)"},{value:"Australia/Melbourne",label:"Melbourne (AEDT)"},{value:"Australia/Brisbane",label:"Brisbane (AEST)"},{value:"Australia/Perth",label:"Perth (AWST)"},{value:"Pacific/Auckland",label:"Auckland (NZDT)"},{value:"Africa/Johannesburg",label:"Johannesburg (SAST)"},{value:"Africa/Nairobi",label:"Nairobi (EAT)"},{value:"Africa/Lagos",label:"Lagos (WAT)"},{value:"Africa/Cairo",label:"Cairo (EET)"}]}setSendImmediately(e){this.sendImmediately=e}validateHour(){if(this.hourError="",this.hourInput===null||this.hourInput===void 0)return;let e=Number(this.hourInput);if(isNaN(e)){this.hourError="Invalid number";return}e<0?(this.hourInput=0,this.hourError="Min is 0"):e>23&&(this.hourInput=23,this.hourError="Max is 23")}validateMinute(){if(this.minuteError="",this.minuteInput===null||this.minuteInput===void 0)return;let e=Number(this.minuteInput);if(isNaN(e)){this.minuteError="Invalid number";return}e<0?(this.minuteInput=0,this.minuteError="Min is 0"):e>59&&(this.minuteInput=59,this.minuteError="Max is 59")}formatHour(){if(this.hourInput!==null&&this.hourInput!==void 0){let e=Number(this.hourInput);!isNaN(e)&&e>=0&&e<=23&&(this.hourInput=e,this.hourError="")}}formatMinute(){if(this.minuteInput!==null&&this.minuteInput!==void 0){let e=Number(this.minuteInput);!isNaN(e)&&e>=0&&e<=59&&(this.minuteInput=e,this.minuteError="")}}selectTimezone(e){this.selectedTimezone=e}isTimeValid(){return this.sendImmediately?!0:this.hourInput!==null&&this.hourInput!==void 0&&this.minuteInput!==null&&this.minuteInput!==void 0&&this.hourInput>=0&&this.hourInput<=23&&this.minuteInput>=0&&this.minuteInput<=59&&!this.hourError&&!this.minuteError}getFormattedTime(){if(!this.isTimeValid()||this.hourInput===null||this.minuteInput===null)return"";let e=this.hourInput,o=this.minuteInput,a=e===0?12:e>12?e-12:e,c=e>=12?"PM":"AM",p=a.toString().padStart(2,"0"),u=o.toString().padStart(2,"0");return`${p}:${u} ${c}`}getMessageClass(){return this.sendImmediately?"warning":this.isTimeValid()?"success":"error"}getMessage(){if(this.sendImmediately)return"\u26A1 Email will be sent immediately when you submit the campaign";if(!this.isTimeValid())return"\u26A0\uFE0F Please enter a valid time (Hour: 0-23, Minute: 0-59)";let e=this.getFormattedTime();if(!this.selectedTimezone)return`\u{1F4C5} Email will be sent at ${e} in your local timezone`;let o=this.timezones.find(a=>a.value===this.selectedTimezone)?.label||this.selectedTimezone;return`\u{1F30D} Email will be sent at ${e} ${o}`}getMessageIcon(){return this.sendImmediately?"flash_on":this.isTimeValid()?"schedule_send":"error_outline"}canConfirm(){return this.sendImmediately?!0:this.isTimeValid()}confirm(){if(!this.canConfirm())return;let e="";if(!this.sendImmediately&&this.hourInput!==null&&this.minuteInput!==null){let o=new Date,a=o.getFullYear(),c=(o.getMonth()+1).toString().padStart(2,"0"),p=o.getDate().toString().padStart(2,"0"),u=this.hourInput.toString().padStart(2,"0"),f=this.minuteInput.toString().padStart(2,"0");e=`${a}-${c}-${p}T${u}:${f}`,console.log("\u{1F4C5} Schedule dialog result:",{time:e,timezone:this.selectedTimezone,email:this.data.email})}this.dialogRef.close({email:this.data.email,time:e,timezone:this.selectedTimezone})}cancel(){this.dialogRef.close(null)}static{this.\u0275fac=function(o){return new(o||i)(k(xe),k(Me))}}static{this.\u0275cmp=V({type:i,selectors:[["app-schedule-email-dialog"]],standalone:!0,features:[L],decls:42,vars:11,consts:[[1,"schedule-dialog"],["mat-dialog-title",""],[1,"email-badge"],[1,"send-options"],[1,"option-card",3,"click"],["class","time-input-section",4,"ngIf"],["class","timezone-section",4,"ngIf"],[1,"info-message",3,"ngClass"],["align","end"],["mat-button","",3,"click"],["mat-raised-button","","color","primary",3,"click","disabled"],[1,"time-input-section"],[1,"time-inputs"],[1,"input-group"],["type","number","placeholder","09","min","0","max","23",1,"time-input",3,"ngModelChange","input","blur","ngModel"],[1,"hint"],["class","error-msg",4,"ngIf"],[1,"time-separator"],["type","number","placeholder","00","min","0","max","59",1,"time-input",3,"ngModelChange","input","blur","ngModel"],["class","time-preview",4,"ngIf"],[1,"error-msg"],[1,"time-preview"],[1,"timezone-section"],[1,"timezone-grid"],[1,"timezone-chip",3,"click"],[1,"chip-content"],[1,"chip-label"],[1,"chip-sublabel"],["class","timezone-chip",3,"selected","click",4,"ngFor","ngForOf"]],template:function(o,a){o&1&&(t(0,"div",0)(1,"h2",1)(2,"mat-icon"),r(3,"schedule_send"),n(),r(4," Schedule Email "),n(),t(5,"mat-dialog-content")(6,"div",2)(7,"mat-icon"),r(8,"email"),n(),t(9,"span"),r(10),n()(),t(11,"div",3)(12,"div",4),_("click",function(){return a.setSendImmediately(!0)}),t(13,"mat-icon"),r(14,"flash_on"),n(),t(15,"h3"),r(16,"Send Immediately"),n(),t(17,"p"),r(18,"Send as soon as you submit"),n()(),t(19,"div",4),_("click",function(){return a.setSendImmediately(!1)}),t(20,"mat-icon"),r(21,"schedule"),n(),t(22,"h3"),r(23,"Schedule for Later"),n(),t(24,"p"),r(25,"Pick a specific time"),n()()(),g(26,Tt,23,9,"div",5)(27,At,15,3,"div",6),t(28,"div",7)(29,"mat-icon"),r(30),n(),t(31,"p"),r(32),n()()(),t(33,"mat-dialog-actions",8)(34,"button",9),_("click",function(){return a.cancel()}),t(35,"mat-icon"),r(36,"close"),n(),r(37," Cancel "),n(),t(38,"button",10),_("click",function(){return a.confirm()}),t(39,"mat-icon"),r(40,"check_circle"),n(),r(41," Add to Master "),n()()()),o&2&&(s(10),b(a.data.email),s(2),T("selected",a.sendImmediately),s(7),T("selected",!a.sendImmediately),s(7),l("ngIf",!a.sendImmediately),s(),l("ngIf",!a.sendImmediately),s(),l("ngClass",a.getMessageClass()),s(2),b(a.getMessageIcon()),s(2),b(a.getMessage()),s(6),l("disabled",!a.canConfirm()))},dependencies:[F,qe,W,q,ye,Pe,Se,Oe,N,J,$,Z,be,pe,me,Qe,de,nt,tt,ge],styles:[".schedule-dialog[_ngcontent-%COMP%]{min-width:600px}h2[mat-dialog-title][_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;color:#1976d2;margin:0;padding:1.5rem;border-bottom:2px solid #e3f2fd}mat-dialog-content[_ngcontent-%COMP%]{padding:1.5rem;max-height:80vh;overflow-y:auto}.email-badge[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;padding:1rem;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border-radius:12px;margin-bottom:1.5rem;box-shadow:0 4px 12px #667eea4d}.email-badge[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:24px;width:24px;height:24px}.email-badge[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:500;font-size:.95rem}.send-options[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:1rem;margin-bottom:2rem}.option-card[_ngcontent-%COMP%]{padding:1.5rem;border:3px solid #e0e0e0;border-radius:16px;cursor:pointer;transition:all .3s ease;text-align:center}.option-card[_ngcontent-%COMP%]:hover{border-color:#1976d2;transform:translateY(-2px);box-shadow:0 6px 20px #1976d233}.option-card.selected[_ngcontent-%COMP%]{border-color:#1976d2;background:linear-gradient(135deg,#e3f2fd,#bbdefb);box-shadow:0 6px 20px #1976d24d}.option-card[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:48px;width:48px;height:48px;color:#1976d2;margin-bottom:.5rem}.option-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:.5rem 0 .25rem;font-size:1.1rem;font-weight:600;color:#424242}.option-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:.85rem;color:#757575}.time-input-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], .timezone-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;color:#424242;font-size:1.1rem;font-weight:600;margin-bottom:1rem}.time-input-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .timezone-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#1976d2}.time-inputs[_ngcontent-%COMP%]{display:flex;align-items:flex-start;justify-content:center;gap:1rem;margin-bottom:1.5rem}.input-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.input-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:.85rem;font-weight:600;color:#757575;text-align:center}.time-input[_ngcontent-%COMP%]{width:100px;font-size:2.5rem;font-weight:700;font-family:Roboto Mono,monospace;text-align:center;padding:1rem;border:3px solid #e0e0e0;border-radius:12px;background:#fff;transition:all .3s ease}.time-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#1976d2;box-shadow:0 0 0 4px #1976d21a}.time-input.error[_ngcontent-%COMP%]{border-color:#f44336;background:#ffebee}.time-input[_ngcontent-%COMP%]::placeholder{color:#bdbdbd}.time-separator[_ngcontent-%COMP%]{font-size:3rem;font-weight:700;color:#1976d2;align-self:center;padding-top:1.5rem}.hint[_ngcontent-%COMP%]{font-size:.75rem;color:#9e9e9e;text-align:center}.error-msg[_ngcontent-%COMP%]{font-size:.75rem;color:#f44336;text-align:center;font-weight:600}.time-preview[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:.75rem;padding:1rem;background:linear-gradient(135deg,#e3f2fd,#bbdefb);border-radius:12px;margin-bottom:1rem}.time-preview[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#1976d2;font-size:28px;width:28px;height:28px}.time-preview[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:700;font-family:Roboto Mono,monospace;color:#1976d2}.timezone-section[_ngcontent-%COMP%]{margin-top:2rem}.timezone-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(160px,1fr));gap:.75rem}.timezone-chip[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;padding:1rem;background:#f5f5f5;border:2px solid #e0e0e0;border-radius:12px;cursor:pointer;transition:all .3s ease}.timezone-chip[_ngcontent-%COMP%]:hover{background:#e8f5e9;border-color:#4caf50;transform:translateY(-2px);box-shadow:0 4px 12px #4caf5033}.timezone-chip.selected[_ngcontent-%COMP%]{background:linear-gradient(135deg,#4caf50,#388e3c);border-color:#4caf50;color:#fff;box-shadow:0 6px 16px #4caf5066}.timezone-chip.selected[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#fff}.timezone-chip[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:24px;width:24px;height:24px;color:#4caf50}.chip-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.25rem}.chip-label[_ngcontent-%COMP%]{font-weight:600;font-size:.9rem}.chip-sublabel[_ngcontent-%COMP%]{font-size:.75rem;opacity:.8}.info-message[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;padding:1rem;border-radius:12px;margin-top:1.5rem;font-size:.95rem}.info-message.success[_ngcontent-%COMP%]{background:#e8f5e9;color:#2e7d32;border:2px solid #4caf50}.info-message.warning[_ngcontent-%COMP%]{background:#fff3e0;color:#e65100;border:2px solid #ff9800}.info-message.error[_ngcontent-%COMP%]{background:#ffebee;color:#c62828;border:2px solid #f44336}.info-message[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:24px;width:24px;height:24px}.info-message[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-weight:500}mat-dialog-actions[_ngcontent-%COMP%]{padding:1rem 1.5rem;border-top:2px solid #e3f2fd;gap:.75rem}mat-dialog-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:.5rem 1.5rem;border-radius:8px;font-weight:600}input[_ngcontent-%COMP%]::-webkit-outer-spin-button, input[_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}input[type=number][_ngcontent-%COMP%]{-moz-appearance:textfield}"]})}}return i})();var vt=(()=>{class i{constructor(){this.http=A(K),this.apiUrl="/api/campaign"}validateAudience(e){return this.http.post(`${this.apiUrl}/validate-audience`,e)}addNewSubscribers(e,o){let a=o.map(c=>({email:c,firstName:"",lastName:""}));return this.http.post(`/api/organizations/${e}/subscribers/bulk-import`,{subscribers:a})}static{this.\u0275fac=function(o){return new(o||i)}}static{this.\u0275prov=Y({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();function Lt(i,m){i&1&&(t(0,"div",8),h(1,"mat-spinner",9),t(2,"p"),r(3,"Validating your audience list..."),n()())}function Ft(i,m){if(i&1){let e=O();t(0,"div",10)(1,"mat-icon",11),r(2,"error"),n(),t(3,"p"),r(4),n(),t(5,"button",12),_("click",function(){x(e);let a=d();return M(a.validateAudience())}),t(6,"mat-icon"),r(7,"refresh"),n(),r(8," Retry "),n()()}if(i&2){let e=d();s(4),b(e.error)}}function Nt(i,m){if(i&1&&(t(0,"mat-list-item",32)(1,"mat-icon",33),r(2,"new_releases"),n(),t(3,"span",34),r(4),n()()),i&2){let e=m.$implicit;s(4),b(e)}}function $t(i,m){if(i&1){let e=O();t(0,"div",35)(1,"button",36),_("click",function(){x(e);let a=d(3);return M(a.prevNewPage())}),t(2,"mat-icon"),r(3,"chevron_left"),n()(),t(4,"span"),r(5),n(),t(6,"button",36),_("click",function(){x(e);let a=d(3);return M(a.nextNewPage())}),t(7,"mat-icon"),r(8,"chevron_right"),n()()()}if(i&2){let e=d(3);s(),l("disabled",e.newPage===0),s(4),se("",e.newPage*e.pageSize+1," - ",e.Math.min((e.newPage+1)*e.pageSize,e.validationResult.masterDocument.new.length)," of ",e.validationResult.masterDocument.new.length,""),s(),l("disabled",!e.hasMoreNew)}}function Rt(i,m){if(i&1){let e=O();t(0,"div",25)(1,"div",26)(2,"div",27)(3,"mat-icon"),r(4,"person_add"),n(),t(5,"h4"),r(6),n()(),t(7,"button",28),_("click",function(){x(e);let a=d(2);return M(a.addAllNewSubscribers())}),t(8,"mat-icon"),r(9,"add_circle"),n(),r(10),n()(),t(11,"mat-list",29),g(12,Nt,5,1,"mat-list-item",30),n(),g(13,$t,9,5,"div",31),n()}if(i&2){let e=d(2);s(6),E("New Subscribers (",e.validationResult.masterDocument.new.length,")"),s(),l("disabled",e.addingSubscribers),s(3),E(" ",e.addingSubscribers?"Adding...":"Add All to Audience"," "),s(2),l("ngForOf",e.paginatedNew),s(),l("ngIf",e.validationResult.masterDocument.new.length>e.pageSize)}}function Gt(i,m){if(i&1&&(t(0,"mat-list-item",40)(1,"mat-icon",41),r(2,"verified"),n(),t(3,"span",34),r(4),n()()),i&2){let e=m.$implicit;s(4),b(e)}}function Ht(i,m){if(i&1){let e=O();t(0,"div",35)(1,"button",36),_("click",function(){x(e);let a=d(3);return M(a.prevExistingPage())}),t(2,"mat-icon"),r(3,"chevron_left"),n()(),t(4,"span"),r(5),n(),t(6,"button",36),_("click",function(){x(e);let a=d(3);return M(a.nextExistingPage())}),t(7,"mat-icon"),r(8,"chevron_right"),n()()()}if(i&2){let e=d(3);s(),l("disabled",e.existingPage===0),s(4),se("",e.existingPage*e.pageSize+1," - ",e.Math.min((e.existingPage+1)*e.pageSize,e.validationResult.masterDocument.existing.length)," of ",e.validationResult.masterDocument.existing.length,""),s(),l("disabled",!e.hasMoreExisting)}}function Bt(i,m){if(i&1&&(t(0,"div",37)(1,"div",38)(2,"mat-icon"),r(3,"check_circle"),n(),t(4,"h4"),r(5),n()(),t(6,"mat-list",29),g(7,Gt,5,1,"mat-list-item",39),n(),g(8,Ht,9,5,"div",31),n()),i&2){let e=d(2);s(5),E("Existing Subscribers (",e.validationResult.masterDocument.existing.length,")"),s(2),l("ngForOf",e.paginatedExisting),s(),l("ngIf",e.validationResult.masterDocument.existing.length>e.pageSize)}}function Ut(i,m){if(i&1){let e=O();t(0,"button",51),_("click",function(a){x(e);let c=d().$implicit;return d(3).addExcludedToMaster(c),M(a.stopPropagation())}),t(1,"mat-icon"),r(2,"add_circle_outline"),n()()}}function Yt(i,m){i&1&&(t(0,"mat-icon",52),r(1," done "),n())}function Wt(i,m){if(i&1){let e=O();t(0,"mat-list-item",47),_("click",function(){let a=x(e).$implicit,c=d(3);return M(c.addExcludedToMaster(a))}),t(1,"mat-icon",48),r(2),n(),t(3,"span",34),r(4),n(),g(5,Ut,3,0,"button",49)(6,Yt,2,0,"mat-icon",50),n()}if(i&2){let e=m.$implicit,o=d(3);T("added-to-master",o.addedToMaster.has(e)),s(),T("red-icon",!o.addedToMaster.has(e))("green-icon",o.addedToMaster.has(e)),s(),E(" ",o.addedToMaster.has(e)?"check_circle":"cancel"," "),s(2),b(e),s(),l("ngIf",!o.addedToMaster.has(e)),s(),l("ngIf",o.addedToMaster.has(e))}}function qt(i,m){if(i&1){let e=O();t(0,"div",35)(1,"button",36),_("click",function(){x(e);let a=d(3);return M(a.prevExcludedPage())}),t(2,"mat-icon"),r(3,"chevron_left"),n()(),t(4,"span"),r(5),n(),t(6,"button",36),_("click",function(){x(e);let a=d(3);return M(a.nextExcludedPage())}),t(7,"mat-icon"),r(8,"chevron_right"),n()()()}if(i&2){let e=d(3);s(),l("disabled",e.excludedPage===0),s(4),se("",e.excludedPage*e.pageSize+1," - ",e.Math.min((e.excludedPage+1)*e.pageSize,e.validationResult.excludedFromCampaign.subscribers.length)," of ",e.validationResult.excludedFromCampaign.subscribers.length,""),s(),l("disabled",!e.hasMoreExcluded)}}function Kt(i,m){if(i&1){let e=O();t(0,"div",42)(1,"div",43)(2,"div",27)(3,"mat-icon"),r(4,"warning"),n(),t(5,"h4"),r(6,"Won't Receive Email"),n()(),t(7,"button",44),_("click",function(){x(e);let a=d(2);return M(a.addAllExcludedToMaster())}),t(8,"mat-icon"),r(9,"add_circle"),n(),r(10),n()(),t(11,"p",45),r(12),n(),t(13,"mat-list",29),g(14,Wt,7,10,"mat-list-item",46),n(),g(15,qt,9,5,"div",31),n()}if(i&2){let e=d(2);s(7),l("disabled",e.addingToMaster),s(3),E(" ",e.addingToMaster?"Adding...":"Add All to Master Document"," "),s(2),E("These are in ",e.data.organizationName||"your audience"," but not in your master document"),s(2),l("ngForOf",e.paginatedExcluded),s(),l("ngIf",e.validationResult.excludedFromCampaign.subscribers.length>e.pageSize)}}function Jt(i,m){if(i&1&&(t(0,"div",53)(1,"mat-icon"),r(2,"check_circle_outline"),n(),t(3,"p"),r(4),n()()),i&2){let e=d(2);s(4),E("All ",e.data.organizationName||"audience"," subscribers are in your master document!")}}function Zt(i,m){if(i&1&&(t(0,"div",13)(1,"div",14)(2,"div",15)(3,"div",16),r(4),n(),t(5,"div",17),r(6,"Total in CSV"),n()(),t(7,"div",15)(8,"div",16),r(9),n(),t(10,"div",17),r(11),n()()(),t(12,"div",18)(13,"div",19)(14,"h3")(15,"mat-icon"),r(16,"upload_file"),n(),r(17),n(),g(18,Rt,14,5,"div",20)(19,Bt,9,3,"div",21),n(),t(20,"div",22)(21,"h3")(22,"mat-icon"),r(23,"block"),n(),r(24),n(),g(25,Kt,16,5,"div",23)(26,Jt,5,1,"div",24),n()()()),i&2){let e=d();s(4),b(e.validationResult.summary.totalInCsv),s(5),b(e.validationResult.summary.totalInMailchimp),s(2),E("Total in ",e.data.organizationName||"Audience",""),s(6),E(" Master Document (",e.validationResult.masterDocument.total+e.addedToMaster.size,") "),s(),l("ngIf",e.validationResult.masterDocument.new.length>0),s(),l("ngIf",e.validationResult.masterDocument.existing.length>0),s(5),E(" Excluded from Campaign (",e.validationResult.excludedFromCampaign.total-e.addedToMaster.size,") "),s(),l("ngIf",e.validationResult.excludedFromCampaign.total>0),s(),l("ngIf",e.validationResult.excludedFromCampaign.total===0)}}var Pt=(()=>{class i{constructor(e,o,a,c,p){this.dialogRef=e,this.data=o,this.campaignService=a,this.orgService=c,this.dialog=p,this.loading=!0,this.validationResult=null,this.error=null,this.addingSubscribers=!1,this.addingToMaster=!1,this.addedToMaster=new Set,this.scheduledEmails=new Map,this.newPage=0,this.existingPage=0,this.excludedPage=0,this.pageSize=50,this.Math=Math}ngOnInit(){this.validateAudience()}validateAudience(){this.loading=!0,this.error=null;let e=new FormData;e.append("csvFile",this.data.csvFile),this.campaignService.validateAudience(e).subscribe({next:o=>{console.log("\u2705 Validation result:",o),this.validationResult=o,this.loading=!1},error:o=>{console.error("\u274C Validation failed:",o),this.error=o.error?.error||"Failed to validate audience",this.loading=!1}})}get paginatedNew(){if(!this.validationResult)return[];let e=this.newPage*this.pageSize;return this.validationResult.masterDocument.new.slice(e,e+this.pageSize)}get paginatedExisting(){if(!this.validationResult)return[];let e=this.existingPage*this.pageSize;return this.validationResult.masterDocument.existing.slice(e,e+this.pageSize)}get paginatedExcluded(){if(!this.validationResult)return[];let e=this.excludedPage*this.pageSize;return this.validationResult.excludedFromCampaign.subscribers.slice(e,e+this.pageSize)}get hasMoreNew(){return this.validationResult?(this.newPage+1)*this.pageSize<this.validationResult.masterDocument.new.length:!1}get hasMoreExisting(){return this.validationResult?(this.existingPage+1)*this.pageSize<this.validationResult.masterDocument.existing.length:!1}get hasMoreExcluded(){return this.validationResult?(this.excludedPage+1)*this.pageSize<this.validationResult.excludedFromCampaign.subscribers.length:!1}nextNewPage(){this.hasMoreNew&&this.newPage++}prevNewPage(){this.newPage>0&&this.newPage--}nextExistingPage(){this.hasMoreExisting&&this.existingPage++}prevExistingPage(){this.existingPage>0&&this.existingPage--}nextExcludedPage(){this.hasMoreExcluded&&this.excludedPage++}prevExcludedPage(){this.excludedPage>0&&this.excludedPage--}addAllNewSubscribers(){if(!this.validationResult||this.validationResult.masterDocument.new.length===0)return;let e=this.data.organizationName||"audience",o=`Add ${this.validationResult.masterDocument.new.length} new subscribers to ${e}?`;if(!confirm(o))return;this.addingSubscribers=!0;let a=this.validationResult.masterDocument.new.map(c=>({email:c,firstName:"",lastName:""}));this.orgService.bulkImportSubscribers(this.data.organizationId,a).subscribe({next:c=>{console.log("\u2705 Added subscribers:",c),alert(`Successfully added ${c.addedCount} subscribers to ${e}!`),this.validateAudience(),this.addingSubscribers=!1},error:c=>{console.error("\u274C Failed to add subscribers:",c),alert("Failed to add subscribers: "+(c.error?.error||"Unknown error")),this.addingSubscribers=!1}})}addExcludedToMaster(e){if(this.addedToMaster.has(e)){this.addedToMaster.delete(e),this.scheduledEmails.delete(e);return}this.dialog.open(je,{width:"600px",data:{email:e}}).afterClosed().subscribe(a=>{a&&(this.addedToMaster.add(e),this.scheduledEmails.set(e,{email:a.email,time:a.time||"",timezone:a.timezone||""}))})}addAllExcludedToMaster(){if(!this.validationResult||this.validationResult.excludedFromCampaign.total===0)return;this.dialog.open(je,{width:"600px",data:{email:`All ${this.validationResult.excludedFromCampaign.total} excluded subscribers`}}).afterClosed().subscribe(o=>{o&&(this.addingToMaster=!0,this.validationResult.excludedFromCampaign.subscribers.forEach(a=>{this.addedToMaster.add(a),this.scheduledEmails.set(a,{email:a,time:o.time||"",timezone:o.timezone||""})}),this.addingToMaster=!1)})}proceed(){this.dialogRef.close({validated:!0,result:this.validationResult,addedToMaster:Array.from(this.addedToMaster),scheduledEmails:Array.from(this.scheduledEmails.values())})}cancel(){this.dialogRef.close({validated:!1})}static{this.\u0275fac=function(o){return new(o||i)(k(xe),k(Me),k(vt),k(ht),k(ve))}}static{this.\u0275cmp=V({type:i,selectors:[["app-audience-validation-dialog"]],standalone:!0,features:[L],decls:16,vars:4,consts:[[1,"audience-validation-dialog"],["mat-dialog-title",""],["class","loading-container",4,"ngIf"],["class","error-container",4,"ngIf"],["class","validation-results",4,"ngIf"],["align","end"],["mat-button","",3,"click"],["mat-raised-button","","color","primary",3,"click","disabled"],[1,"loading-container"],["diameter","50"],[1,"error-container"],["color","warn"],["mat-raised-button","",3,"click"],[1,"validation-results"],[1,"summary-stats"],[1,"stat-card"],[1,"stat-value"],[1,"stat-label"],[1,"two-pane-layout"],[1,"left-pane"],["class","subscriber-section new-section",4,"ngIf"],["class","subscriber-section existing-section",4,"ngIf"],[1,"right-pane"],["class","subscriber-section excluded-section",4,"ngIf"],["class","empty-state",4,"ngIf"],[1,"subscriber-section","new-section"],[1,"section-header","orange"],[1,"header-left"],["mat-raised-button","","color","primary",1,"add-all-btn",3,"click","disabled"],[1,"subscriber-list"],["class","orange-item",4,"ngFor","ngForOf"],["class","pagination",4,"ngIf"],[1,"orange-item"],["matListItemIcon","",1,"orange-icon"],["matListItemTitle",""],[1,"pagination"],["mat-button","",3,"click","disabled"],[1,"subscriber-section","existing-section"],[1,"section-header","green"],["class","green-item",4,"ngFor","ngForOf"],[1,"green-item"],["matListItemIcon","",1,"green-icon"],[1,"subscriber-section","excluded-section"],[1,"section-header","red"],["mat-raised-button","","color","warn",1,"add-all-btn",3,"click","disabled"],[1,"info-text"],["class","red-item clickable",3,"added-to-master","click",4,"ngFor","ngForOf"],[1,"red-item","clickable",3,"click"],["matListItemIcon",""],["mat-icon-button","","matListItemMeta","","matTooltip","Add to master document",3,"click",4,"ngIf"],["matListItemMeta","","class","added-badge","matTooltip","Added to master",4,"ngIf"],["mat-icon-button","","matListItemMeta","","matTooltip","Add to master document",3,"click"],["matListItemMeta","","matTooltip","Added to master",1,"added-badge"],[1,"empty-state"]],template:function(o,a){o&1&&(t(0,"div",0)(1,"h2",1)(2,"mat-icon"),r(3,"groups"),n(),r(4," Audience Validation "),n(),t(5,"mat-dialog-content"),g(6,Lt,4,0,"div",2)(7,Ft,9,1,"div",3)(8,Zt,27,9,"div",4),n(),t(9,"mat-dialog-actions",5)(10,"button",6),_("click",function(){return a.cancel()}),r(11,"Cancel"),n(),t(12,"button",7),_("click",function(){return a.proceed()}),t(13,"mat-icon"),r(14,"send"),n(),r(15," Proceed with Campaign "),n()()()),o&2&&(s(6),l("ngIf",a.loading),s(),l("ngIf",a.error&&!a.loading),s(),l("ngIf",a.validationResult&&!a.loading),s(4),l("disabled",!a.validationResult||a.loading))},dependencies:[F,W,q,ye,Pe,Se,Oe,N,J,dt,$,Z,he,ue,be,mt,ct,lt,st,ot,rt,_t,Ce,fe],styles:[".audience-validation-dialog[_ngcontent-%COMP%]{min-width:900px;max-width:1200px}.audience-validation-dialog[_ngcontent-%COMP%]   h2[mat-dialog-title][_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;margin:0;padding:1.5rem;border-bottom:1px solid #e0e0e0}.audience-validation-dialog[_ngcontent-%COMP%]   h2[mat-dialog-title][_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#1976d2}.audience-validation-dialog[_ngcontent-%COMP%]   mat-dialog-content[_ngcontent-%COMP%]{padding:1.5rem;min-height:400px;max-height:60vh;overflow-y:auto}.audience-validation-dialog[_ngcontent-%COMP%]   mat-dialog-actions[_ngcontent-%COMP%]{padding:1rem 1.5rem;border-top:1px solid #e0e0e0;gap:.75rem}@media (max-width: 1024px){.audience-validation-dialog[_ngcontent-%COMP%]{min-width:700px;max-width:90vw}.audience-validation-dialog[_ngcontent-%COMP%]   mat-dialog-content[_ngcontent-%COMP%]{max-height:55vh}}@media (max-width: 768px){.audience-validation-dialog[_ngcontent-%COMP%]{min-width:95vw;max-width:95vw}.audience-validation-dialog[_ngcontent-%COMP%]   mat-dialog-content[_ngcontent-%COMP%]{max-height:50vh;padding:1rem}.audience-validation-dialog[_ngcontent-%COMP%]   h2[mat-dialog-title][_ngcontent-%COMP%]{padding:1rem;font-size:1.25rem}.audience-validation-dialog[_ngcontent-%COMP%]   mat-dialog-actions[_ngcontent-%COMP%]{padding:.75rem 1rem}}.loading-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:300px;gap:1rem}.loading-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#666;font-size:.875rem}.error-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:300px;gap:1rem}.error-container[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:48px;width:48px;height:48px}.error-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#f44336;font-size:1rem;text-align:center}.validation-results[_ngcontent-%COMP%]   .summary-stats[_ngcontent-%COMP%]{display:flex;gap:1rem;margin-bottom:1.5rem}.validation-results[_ngcontent-%COMP%]   .summary-stats[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]{flex:1;padding:1rem;background:linear-gradient(135deg,#667eea,#764ba2);border-radius:8px;text-align:center;color:#fff}.validation-results[_ngcontent-%COMP%]   .summary-stats[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]   .stat-value[_ngcontent-%COMP%]{font-size:2rem;font-weight:700;margin-bottom:.25rem}.validation-results[_ngcontent-%COMP%]   .summary-stats[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]   .stat-label[_ngcontent-%COMP%]{font-size:.875rem;opacity:.9}.validation-results[_ngcontent-%COMP%]   .two-pane-layout[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:1.5rem;margin-top:1.5rem}.validation-results[_ngcontent-%COMP%]   .two-pane-layout[_ngcontent-%COMP%]   .left-pane[_ngcontent-%COMP%], .validation-results[_ngcontent-%COMP%]   .two-pane-layout[_ngcontent-%COMP%]   .right-pane[_ngcontent-%COMP%]{background:#f9f9f9;border-radius:8px;padding:1rem}.validation-results[_ngcontent-%COMP%]   .two-pane-layout[_ngcontent-%COMP%]   .left-pane[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], .validation-results[_ngcontent-%COMP%]   .two-pane-layout[_ngcontent-%COMP%]   .right-pane[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;margin:0 0 1rem;font-size:1.1rem;font-weight:600;color:#333}.validation-results[_ngcontent-%COMP%]   .two-pane-layout[_ngcontent-%COMP%]   .left-pane[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .validation-results[_ngcontent-%COMP%]   .two-pane-layout[_ngcontent-%COMP%]   .right-pane[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#1976d2}.validation-results[_ngcontent-%COMP%]   .subscriber-section[_ngcontent-%COMP%]{margin-bottom:1.5rem;background:#fff;border-radius:8px;padding:1rem;box-shadow:0 2px 4px #0000001a}.validation-results[_ngcontent-%COMP%]   .subscriber-section[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;margin-bottom:.75rem;padding-bottom:.75rem;border-bottom:2px solid}.validation-results[_ngcontent-%COMP%]   .subscriber-section[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.validation-results[_ngcontent-%COMP%]   .subscriber-section[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0;font-size:1rem;font-weight:600}.validation-results[_ngcontent-%COMP%]   .subscriber-section[_ngcontent-%COMP%]   .section-header.orange[_ngcontent-%COMP%]{border-bottom-color:#ff9800}.validation-results[_ngcontent-%COMP%]   .subscriber-section[_ngcontent-%COMP%]   .section-header.orange[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .validation-results[_ngcontent-%COMP%]   .subscriber-section[_ngcontent-%COMP%]   .section-header.orange[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{color:#ff9800}.validation-results[_ngcontent-%COMP%]   .subscriber-section[_ngcontent-%COMP%]   .section-header.green[_ngcontent-%COMP%]{border-bottom-color:#4caf50}.validation-results[_ngcontent-%COMP%]   .subscriber-section[_ngcontent-%COMP%]   .section-header.green[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .validation-results[_ngcontent-%COMP%]   .subscriber-section[_ngcontent-%COMP%]   .section-header.green[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{color:#4caf50}.validation-results[_ngcontent-%COMP%]   .subscriber-section[_ngcontent-%COMP%]   .section-header.red[_ngcontent-%COMP%]{border-bottom-color:#f44336}.validation-results[_ngcontent-%COMP%]   .subscriber-section[_ngcontent-%COMP%]   .section-header.red[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .validation-results[_ngcontent-%COMP%]   .subscriber-section[_ngcontent-%COMP%]   .section-header.red[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{color:#f44336}.validation-results[_ngcontent-%COMP%]   .subscriber-section[_ngcontent-%COMP%]   .add-all-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:.5rem}.validation-results[_ngcontent-%COMP%]   .subscriber-section[_ngcontent-%COMP%]   .info-text[_ngcontent-%COMP%]{margin:0 0 1rem;color:#666;font-size:.875rem;font-style:italic}.validation-results[_ngcontent-%COMP%]   .subscriber-section[_ngcontent-%COMP%]   .subscriber-list[_ngcontent-%COMP%]{max-height:300px;overflow-y:auto;padding:0}.validation-results[_ngcontent-%COMP%]   .subscriber-section[_ngcontent-%COMP%]   .subscriber-list[_ngcontent-%COMP%]   mat-list-item[_ngcontent-%COMP%]{height:48px;border-bottom:1px solid #f0f0f0}.validation-results[_ngcontent-%COMP%]   .subscriber-section[_ngcontent-%COMP%]   .subscriber-list[_ngcontent-%COMP%]   mat-list-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.validation-results[_ngcontent-%COMP%]   .subscriber-section[_ngcontent-%COMP%]   .subscriber-list[_ngcontent-%COMP%]   mat-list-item.clickable[_ngcontent-%COMP%]{cursor:pointer;transition:all .2s ease}.validation-results[_ngcontent-%COMP%]   .subscriber-section[_ngcontent-%COMP%]   .subscriber-list[_ngcontent-%COMP%]   mat-list-item.clickable[_ngcontent-%COMP%]:hover{transform:translate(4px)}.validation-results[_ngcontent-%COMP%]   .subscriber-section[_ngcontent-%COMP%]   .subscriber-list[_ngcontent-%COMP%]   mat-list-item.clickable[_ngcontent-%COMP%]   button[matListItemMeta][_ngcontent-%COMP%]{opacity:0;transition:opacity .2s ease}.validation-results[_ngcontent-%COMP%]   .subscriber-section[_ngcontent-%COMP%]   .subscriber-list[_ngcontent-%COMP%]   mat-list-item.clickable[_ngcontent-%COMP%]:hover   button[matListItemMeta][_ngcontent-%COMP%]{opacity:1}.validation-results[_ngcontent-%COMP%]   .subscriber-section[_ngcontent-%COMP%]   .subscriber-list[_ngcontent-%COMP%]   mat-list-item.orange-item[_ngcontent-%COMP%]{background:#fff3e0}.validation-results[_ngcontent-%COMP%]   .subscriber-section[_ngcontent-%COMP%]   .subscriber-list[_ngcontent-%COMP%]   mat-list-item.orange-item[_ngcontent-%COMP%]:hover{background:#ffe0b2}.validation-results[_ngcontent-%COMP%]   .subscriber-section[_ngcontent-%COMP%]   .subscriber-list[_ngcontent-%COMP%]   mat-list-item.orange-item[_ngcontent-%COMP%]   .orange-icon[_ngcontent-%COMP%]{color:#ff9800}.validation-results[_ngcontent-%COMP%]   .subscriber-section[_ngcontent-%COMP%]   .subscriber-list[_ngcontent-%COMP%]   mat-list-item.green-item[_ngcontent-%COMP%]{background:#e8f5e9}.validation-results[_ngcontent-%COMP%]   .subscriber-section[_ngcontent-%COMP%]   .subscriber-list[_ngcontent-%COMP%]   mat-list-item.green-item[_ngcontent-%COMP%]:hover{background:#c8e6c9}.validation-results[_ngcontent-%COMP%]   .subscriber-section[_ngcontent-%COMP%]   .subscriber-list[_ngcontent-%COMP%]   mat-list-item.green-item[_ngcontent-%COMP%]   .green-icon[_ngcontent-%COMP%]{color:#4caf50}.validation-results[_ngcontent-%COMP%]   .subscriber-section[_ngcontent-%COMP%]   .subscriber-list[_ngcontent-%COMP%]   mat-list-item.red-item[_ngcontent-%COMP%]{background:#ffebee}.validation-results[_ngcontent-%COMP%]   .subscriber-section[_ngcontent-%COMP%]   .subscriber-list[_ngcontent-%COMP%]   mat-list-item.red-item[_ngcontent-%COMP%]:hover{background:#ffcdd2}.validation-results[_ngcontent-%COMP%]   .subscriber-section[_ngcontent-%COMP%]   .subscriber-list[_ngcontent-%COMP%]   mat-list-item.red-item[_ngcontent-%COMP%]   .red-icon[_ngcontent-%COMP%]{color:#f44336}.validation-results[_ngcontent-%COMP%]   .subscriber-section[_ngcontent-%COMP%]   .subscriber-list[_ngcontent-%COMP%]   mat-list-item.red-item.added-to-master[_ngcontent-%COMP%]{background:#e8f5e9;border-left:4px solid #4caf50}.validation-results[_ngcontent-%COMP%]   .subscriber-section[_ngcontent-%COMP%]   .subscriber-list[_ngcontent-%COMP%]   mat-list-item.red-item.added-to-master[_ngcontent-%COMP%]:hover{background:#c8e6c9}.validation-results[_ngcontent-%COMP%]   .subscriber-section[_ngcontent-%COMP%]   .subscriber-list[_ngcontent-%COMP%]   mat-list-item.red-item.added-to-master[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{text-decoration:line-through;opacity:.7}.validation-results[_ngcontent-%COMP%]   .subscriber-section[_ngcontent-%COMP%]   .subscriber-list[_ngcontent-%COMP%]   mat-list-item.red-item[_ngcontent-%COMP%]   .added-badge[_ngcontent-%COMP%]{color:#4caf50;font-size:18px}.validation-results[_ngcontent-%COMP%]   .subscriber-section[_ngcontent-%COMP%]   .subscriber-list[_ngcontent-%COMP%]   mat-list-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.875rem;font-family:Courier New,monospace}.validation-results[_ngcontent-%COMP%]   .subscriber-section[_ngcontent-%COMP%]   .pagination[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:1rem;margin-top:1rem;padding-top:1rem;border-top:1px solid #e0e0e0}.validation-results[_ngcontent-%COMP%]   .subscriber-section[_ngcontent-%COMP%]   .pagination[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.875rem;color:#666}.validation-results[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:200px;color:#999}.validation-results[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:48px;width:48px;height:48px;margin-bottom:1rem}.validation-results[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:.875rem}.subscriber-list[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.subscriber-list[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f1f1;border-radius:3px}.subscriber-list[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#888;border-radius:3px}.subscriber-list[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#555}"]})}}return i})();var Ot=(()=>{class i{constructor(e){this.http=e,this.audiencesSubject=new z([]),this.audiences$=this.audiencesSubject.asObservable(),this.selectedAudienceSubject=new z(null),this.selectedAudience$=this.selectedAudienceSubject.asObservable(),this.masterDataSubject=new z([]),this.masterData$=this.masterDataSubject.asObservable(),this.reconciliationSubject=new z(null),this.reconciliation$=this.reconciliationSubject.asObservable(),this.timezoneAnalysisSubject=new z(null),this.timezoneAnalysis$=this.timezoneAnalysisSubject.asObservable()}fetchMailchimpAudiences(){return this.http.get("/api/mailchimp/audiences").pipe(Ie(e=>{let o=(e.lists||[]).map(a=>({id:a.id,name:a.name,memberCount:a.stats?.member_count||0,stats:a.stats||{member_count:0,unsubscribe_count:0,cleaned_count:0}}));return this.audiencesSubject.next(o),o}),D(e=>G(()=>new Error("Failed to load Mailchimp audiences"))))}selectAudience(e){this.selectedAudienceSubject.next(e)}uploadMasterDocument(e){let o=new FormData;return o.append("file",e),this.http.post("/api/campaign/upload-master",o).pipe(Ie(a=>{let c=a.data||[];this.masterDataSubject.next(c);let p=this.analyzeTimezones(c);return this.timezoneAnalysisSubject.next(p),c}),D(a=>G(()=>new Error("Failed to parse master document"))))}analyzeTimezones(e){let o=e.some(f=>"timezone"in f);if(!o)return{hasTimezoneColumn:!1,uniqueTimezones:[],timezoneMode:"none",emptyTimezoneCount:e.length,totalRows:e.length};let a=e.map(f=>f.timezone?.trim()).filter(f=>f&&f.length>0),c=Array.from(new Set(a)),p=e.length-a.length,u;return a.length===0?u="none":c.length===1&&p===0?u="single":c.length>1&&p===0?u="multiple":u="mixed",{hasTimezoneColumn:o,uniqueTimezones:c,timezoneMode:u,emptyTimezoneCount:p,totalRows:e.length}}reconcileAudiences(e,o){return this.http.post("/api/campaign/reconcile",{audienceId:e,emails:o}).pipe($e(a=>{this.reconciliationSubject.next(a)}),D(a=>G(()=>new Error("Failed to reconcile audiences"))))}sendTestEmails(e,o,a){return this.http.post("/api/campaign/send-test",{testEmails:e,subject:o,html:a}).pipe(D(c=>G(()=>new Error("Failed to send test emails"))))}groupByScheduleTime(e){let o=new Map,a=[],c=Intl.DateTimeFormat().resolvedOptions().timeZone;e.forEach(u=>{let f=u.audiences_list?.trim().toLowerCase(),I=u.scheduled_time?.trim(),y=u.timezone?.trim();if(f){if(console.log(`\u{1F4C5} Processing schedule for ${f}:`,{timeStr:I,timezone:y,isEmpty:!I}),!I){a.push(f),console.log("  \u26A1 Marked as immediate (no time)");return}try{let w;if(y?w=this.parseTimeInTimezone(I,y):w=new Date(I),isNaN(w.getTime()))throw new Error("Invalid date");let B=`${w.toISOString()}_${y||"LOCAL"}`;o.has(B)||o.set(B,{emails:[],timezone:y||c}),o.get(B).emails.push(f)}catch{a.push(f)}}});let p=[];return a.length>0&&p.push({scheduledTime:new Date,emails:Array.from(new Set(a)),count:a.length,isImmediate:!0,timezoneSource:"none"}),o.forEach((u,f)=>{let[I,y]=f.split("_"),w=y==="LOCAL";p.push({scheduledTime:new Date(I),emails:Array.from(new Set(u.emails)),count:u.emails.length,isImmediate:!1,timezone:u.timezone,timezoneSource:w?"local":"customer"})}),p.sort((u,f)=>u.isImmediate&&!f.isImmediate?-1:!u.isImmediate&&f.isImmediate?1:u.scheduledTime.getTime()-f.scheduledTime.getTime()),p}parseTimeInTimezone(e,o){if(e.includes("+")||e.match(/-\d{2}:\d{2}$/))return new Date(e);try{let a=new Date(e),c={timeZone:o,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1};return new Date(a.toLocaleString("en-US",c))}catch{try{return new Date(e+" "+o)}catch{return new Date(e)}}}submitCampaign(e){return this.http.post("/api/campaign/submit",e).pipe(D(o=>(console.error("Submit campaign error:",o),G(()=>o))))}extractTestEmails(e){let o=new Set;return e.forEach(a=>{let c=a.test_emails?.trim();c&&c.split(",").forEach(p=>{let u=p.trim().toLowerCase();this.isValidEmail(u)&&o.add(u)})}),Array.from(o)}isValidEmail(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}clearState(){this.audiencesSubject.next([]),this.selectedAudienceSubject.next(null),this.masterDataSubject.next([]),this.reconciliationSubject.next(null),this.timezoneAnalysisSubject.next(null)}getCurrentTimezoneAnalysis(){return this.timezoneAnalysisSubject.value}getBrowserTimezone(){return Intl.DateTimeFormat().resolvedOptions().timeZone}hasImmediateSends(e){return e.some(o=>o.isImmediate)}getImmediateSendCount(e){return e.find(a=>a.isImmediate)?.count||0}isValidTimezone(e){try{return Intl.DateTimeFormat(void 0,{timeZone:e}),!0}catch{return!1}}cleanupTempMembers(e,o){return this.http.post("/api/campaign/cleanup-temp",{audienceId:e,emails:o})}addNewMembersToAudience(e,o){return this.http.post("/api/campaign/add-members",{audienceId:e,emails:o}).pipe(D(a=>G(()=>new Error("Failed to add members to audience"))))}static{this.\u0275fac=function(o){return new(o||i)(Re(K))}}static{this.\u0275prov=Y({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();function en(i,m){i&1&&(t(0,"div",32),h(1,"mat-spinner",33),t(2,"p",34),r(3,"Checking sender settings..."),n()())}function tn(i,m){if(i&1){let e=O();t(0,"div",35)(1,"div",36),C(),t(2,"svg",6),h(3,"circle",37)(4,"line",38)(5,"line",39),n()(),v(),t(6,"h2"),r(7,"\u26A0\uFE0F Configuration Required"),n(),t(8,"p",40),r(9," Your organization's "),t(10,"strong"),r(11,"sender email and name"),n(),r(12," must be configured before you can submit campaigns. "),n(),t(13,"div",41)(14,"h3"),r(15,"What to do:"),n(),t(16,"ol")(17,"li"),r(18,"Contact your "),t(19,"strong"),r(20,"Organization Administrator"),n()(),t(21,"li"),r(22,"Ask them to configure sender settings in the "),t(23,"strong"),r(24,"Admin Dashboard \u2192 Organization Settings"),n(),r(25," tab"),n(),t(26,"li"),r(27,'Once configured, click "Check Again" below'),n()()(),t(28,"div",42)(29,"button",43),_("click",function(){x(e);let a=d(2);return M(a.checkSenderSettings())}),t(30,"mat-icon"),r(31,"refresh"),n(),r(32," Check Again "),n(),t(33,"button",44),_("click",function(){x(e);let a=d(2);return M(a.goBackFromBlockedPage())}),t(34,"mat-icon"),r(35,"arrow_back"),n(),r(36," Go Back "),n()()()}}function nn(i,m){if(i&1&&(t(0,"div",28)(1,"div",29),g(2,en,4,0,"div",30)(3,tn,37,0,"div",31),n()()),i&2){let e=d();s(2),l("ngIf",e.checkingSenderSettings),s(),l("ngIf",!e.checkingSenderSettings)}}function an(i,m){i&1&&(t(0,"div",45),h(1,"mat-progress-spinner",46),t(2,"p"),r(3,"Loading Mailchimp audiences..."),n()())}function on(i,m){if(i&1){let e=O();t(0,"div",47),C(),t(1,"svg",6),h(2,"circle",37)(3,"line",38)(4,"line",39),n(),v(),t(5,"p"),r(6,"Failed to load audiences"),n(),t(7,"button",44),_("click",function(){x(e);let a=d();return M(a.loadMailchimpAudiences())}),r(8,"Retry"),n()()}}function rn(i,m){i&1&&(t(0,"div",55),C(),t(1,"svg",6),h(2,"path",56),n()())}function sn(i,m){if(i&1){let e=O();t(0,"div",50),_("click",function(){let a=x(e).$implicit,c=d(2);return M(c.selectAudience(a))}),t(1,"div",51)(2,"div",52),r(3),n(),t(4,"div",53),r(5),P(6,"number"),n()(),g(7,rn,3,0,"div",54),n()}if(i&2){let e=m.$implicit,o=d(2);T("selected",(o.selectedAudience==null?null:o.selectedAudience.id)===e.id),s(3),b(e.name),s(2),E("",S(6,5,e.memberCount)," members"),s(2),l("ngIf",(o.selectedAudience==null?null:o.selectedAudience.id)===e.id)}}function cn(i,m){if(i&1&&(t(0,"div",48),g(1,sn,8,7,"div",49),n()),i&2){let e=d();s(),l("ngForOf",e.audiences)}}function ln(i,m){i&1&&(t(0,"div",57),C(),t(1,"svg",6),h(2,"circle",37)(3,"line",38)(4,"line",39),n(),v(),t(5,"p"),r(6,"No audiences found"),n(),t(7,"small"),r(8,"Create an audience in Mailchimp first"),n()())}function mn(i,m){i&1&&h(0,"mat-progress-spinner",58)}function dn(i,m){if(i&1&&(t(0,"div",59)(1,"div",60),C(),t(2,"svg",6),h(3,"path",56),n(),v(),t(4,"div",61)(5,"strong"),r(6),P(7,"number"),n(),t(8,"small"),r(9),n()()()()),i&2){let e=d();s(6),E("",S(7,3,e.masterData.length)," rows uploaded"),s(3),Ue("",e.testEmails.length," test email(s) \u2022 ",e.scheduleGroups.length," time slot(s)")}}function gn(i,m){i&1&&(t(0,"div",62),C(),t(1,"svg",6),h(2,"circle",37)(3,"line",63)(4,"line",64),n(),v(),t(5,"p"),r(6,"Upload failed. Check file format."),n()())}function pn(i,m){i&1&&(t(0,"div",45),h(1,"mat-progress-spinner",46),t(2,"p"),r(3,"Reconciling audiences..."),n()())}function un(i,m){if(i&1&&(t(0,"div",66)(1,"div",67)(2,"div",68)(3,"div",69),C(),t(4,"svg",6),h(5,"path",56),n()(),v(),t(6,"div",70)(7,"div",71),r(8),P(9,"number"),n(),t(10,"div",72),r(11,"Existing"),n()()(),t(12,"div",73)(13,"div",69),C(),t(14,"svg",6),h(15,"path",74),n()(),v(),t(16,"div",70)(17,"div",71),r(18),P(19,"number"),n(),t(20,"div",72),r(21,"New"),n()()(),t(22,"div",75)(23,"div",69),C(),t(24,"svg",6),h(25,"path",76),n()(),v(),t(26,"div",70)(27,"div",71),r(28),P(29,"number"),n(),t(30,"div",72),r(31,"Ignored"),n()()()()()),i&2){let e=d(2);s(8),b(S(9,3,e.reconciliation.summary.existingCount)),s(10),b(S(19,5,e.reconciliation.summary.newCount)),s(10),b(S(29,7,e.reconciliation.summary.ignoredCount))}}function hn(i,m){if(i&1&&(t(0,"div",3)(1,"div",4)(2,"div",5),C(),t(3,"svg",6),h(4,"path",56),n()(),v(),t(5,"div",10)(6,"h3"),r(7,"Audience Reconciliation"),n(),t(8,"p"),r(9,"Comparison with Mailchimp data"),n()(),t(10,"div",11),r(11,"Step 3"),n()(),g(12,pn,4,0,"div",12),P(13,"async"),g(14,un,32,9,"div",65),P(15,"async"),n()),i&2){let e=d();s(12),l("ngIf",S(13,2,e.reconcileLoading$)==="loading"),s(2),l("ngIf",S(15,4,e.reconcileLoading$)==="success")}}function _n(i,m){if(i&1){let e=O();t(0,"div",77)(1,"div",78)(2,"input",79),oe("ngModelChange",function(a){x(e);let c=d();return ae(c.addNewMembersToAudience,a)||(c.addNewMembersToAudience=a),M(a)}),n(),t(3,"label",80),C(),t(4,"svg",6),h(5,"path",81)(6,"circle",82)(7,"line",83)(8,"line",84),n(),v(),t(9,"small",85),r(10," Checked: New members saved permanently"),h(11,"br"),r(12," Unchecked: New members archived after campaign sent "),n()()()()}if(i&2){let e=d();s(2),ie("ngModel",e.addNewMembersToAudience)}}function bn(i,m){i&1&&h(0,"mat-progress-spinner",106)}function fn(i,m){i&1&&(C(),t(0,"svg",6),h(1,"path",107),n())}function Cn(i,m){if(i&1){let e=O();t(0,"div",111),_("click",function(){let a=x(e).$implicit,c=d(3);return M(c.onSelectSubject(a))}),t(1,"div",112)(2,"span",113),r(3),n()(),t(4,"div",114),C(),t(5,"svg",6),h(6,"path",115),n()()()}if(i&2){let e=m.$implicit,o=d(3);T("selected",o.isSubjectSelected(e)),s(3),b(e)}}function xn(i,m){i&1&&(t(0,"div",116),C(),t(1,"svg",6),h(2,"path",92),n(),v(),t(3,"p"),r(4,'Click "Generate" to create subject line suggestions'),n()())}function Mn(i,m){if(i&1&&(t(0,"div",108),g(1,Cn,7,3,"div",109)(2,xn,5,0,"div",110),n()),i&2){let e=m.ngIf,o=d(2);s(),l("ngForOf",e)("ngForTrackBy",o.trackByIndex),s(),l("ngIf",e.length===0)}}function vn(i,m){i&1&&(t(0,"div",117),h(1,"mat-progress-spinner",46),t(2,"p"),r(3,"Generating subject lines..."),n()())}function Pn(i,m){i&1&&(t(0,"div",118),r(1," Subject line is required "),n())}function On(i,m){i&1&&(te(0),t(1,"div",143)(2,"mat-icon"),r(3,"bolt"),n(),t(4,"strong"),r(5,"Immediate Send"),n()(),t(6,"div",144),r(7,"Will be sent immediately when you submit"),n(),ne())}function Sn(i,m){i&1&&(t(0,"span",151),r(1,"Customer Timezone"),n())}function yn(i,m){i&1&&(t(0,"span",152),r(1,"Local Timezone"),n())}function wn(i,m){if(i&1&&(t(0,"div",148)(1,"mat-icon"),r(2,"public"),n(),t(3,"span"),r(4),n(),g(5,Sn,2,0,"span",149)(6,yn,2,0,"span",150),n()),i&2){let e=d(2).$implicit;s(4),b(e.timezone),s(),l("ngIf",e.timezoneSource==="customer"),s(),l("ngIf",e.timezoneSource==="local")}}function En(i,m){i&1&&(t(0,"div",153)(1,"mat-icon"),r(2,"warning"),n(),t(3,"span"),r(4,"No timezone specified - using local time"),n()())}function In(i,m){if(i&1&&(te(0),t(1,"div",145)(2,"mat-icon"),r(3,"schedule"),n(),t(4,"strong"),r(5),P(6,"date"),n()(),g(7,wn,7,3,"div",146)(8,En,5,0,"div",147),ne()),i&2){let e=d().$implicit;s(5),b(Te(6,3,e.scheduledTime,"short")),s(2),l("ngIf",e.timezone),s(),l("ngIf",!e.timezone)}}function kn(i,m){if(i&1&&(t(0,"div",137)(1,"div",138)(2,"span",139),r(3),n(),t(4,"span",140),r(5),n()(),t(6,"div",141),g(7,On,8,0,"ng-container",142)(8,In,9,6,"ng-container",142),n()()),i&2){let e=m.$implicit;s(3),b(e.count),s(2),b(e.count===1?"recipient":"recipients"),s(2),l("ngIf",e.isImmediate),s(),l("ngIf",!e.isImmediate)}}function Tn(i,m){if(i&1&&(t(0,"div",157)(1,"div",158)(2,"strong"),r(3,"\u23F0 Timezone Notice"),n(),t(4,"p"),r(5),n()()()),i&2){let e=d(4);s(5),b(e.getTimezoneWarningMessage())}}function zn(i,m){if(i&1&&(t(0,"div",159),C(),t(1,"svg",6),h(2,"circle",37)(3,"path",160),n(),v(),t(4,"div",161)(5,"strong"),r(6,"\u{1F30D} Timezone Configuration"),n(),t(7,"p"),r(8),n()()()),i&2){let e=d(4);s(8),b(e.getTimezoneWarningMessage())}}function An(i,m){if(i&1&&(t(0,"div",154),g(1,Tn,6,1,"div",155)(2,zn,9,1,"div",156),n()),i&2){let e=d(3);s(),l("ngIf",e.shouldShowTimezoneWarning()),s(),l("ngIf",e.shouldShowTimezoneInfo())}}function jn(i,m){if(i&1&&(t(0,"div",162),C(),t(1,"svg",6),h(2,"path",163),n(),v(),t(3,"div",164)(4,"strong"),r(5,"\u26A1 Immediate Send"),n(),t(6,"p"),r(7),t(8,"strong"),r(9,"no schedule time"),n(),r(10," and will be sent "),t(11,"strong"),r(12,"immediately"),n(),r(13,' when you click "Submit Campaign"'),n()()()),i&2){let e=d(3);s(7),E("",e.getImmediateSendCount()," recipient(s) have ")}}function Dn(i,m){i&1&&(te(0),C(),t(1,"svg",6),h(2,"path",163),n(),v(),t(3,"strong"),r(4,"Send Immediately"),n(),ne())}function Vn(i,m){if(i&1&&(t(0,"span",172),C(),t(1,"svg",6),h(2,"circle",37)(3,"polyline",121),n(),r(4),n()),i&2){let e=d(2).$implicit;s(4),E(" ",e.timezone," ")}}function Ln(i,m){i&1&&(t(0,"span",173),C(),t(1,"svg",6),h(2,"path",174),n(),r(3," Local Time "),n())}function Fn(i,m){if(i&1&&(te(0),t(1,"div",168)(2,"span",169),r(3),P(4,"date"),n(),g(5,Vn,5,1,"span",170)(6,Ln,4,0,"span",171),n(),ne()),i&2){let e=d().$implicit;s(3),b(Te(4,3,e.scheduledTime,"short")),s(2),l("ngIf",e.timezone),s(),l("ngIf",e.timezoneSource==="local")}}function Nn(i,m){if(i&1&&(t(0,"div",165)(1,"div",166),g(2,Dn,5,0,"ng-container",142)(3,Fn,7,6,"ng-container",142),n(),t(4,"div",167),r(5),n()()),i&2){let e=m.$implicit;T("immediate",e.isImmediate)("local-timezone",e.timezoneSource==="local"),s(2),l("ngIf",e.isImmediate),s(),l("ngIf",!e.isImmediate),s(2),E(" ",e.count," recipient(s) ")}}function $n(i,m){i&1&&(t(0,"div",178),C(),t(1,"svg",6),h(2,"path",174),n(),v(),t(3,"div",158)(4,"strong"),r(5,"\u26A0\uFE0F No Test Emails Found"),n(),t(6,"p"),r(7,"Your uploaded file has no test emails in the "),t(8,"code"),r(9,"test_emails"),n(),r(10," column. You can still submit, but testing is highly recommended."),n()()())}function Rn(i,m){if(i&1&&(t(0,"span",187),r(1),n()),i&2){let e=m.$implicit;s(),E(" ",e," ")}}function Gn(i,m){if(i&1&&(t(0,"span",188),r(1),n()),i&2){let e=d(5);s(),E(" +",e.testEmails.length-5," more ")}}function Hn(i,m){i&1&&h(0,"mat-progress-spinner",106)}function Bn(i,m){if(i&1&&(t(0,"div",189),C(),t(1,"svg",6),h(2,"path",56),n(),v(),t(3,"span"),r(4),n()()),i&2){let e=d(5);s(4),E("Test email sent ",e.getTestEmailsSentTime(),"")}}function Un(i,m){if(i&1){let e=O();t(0,"div",179)(1,"div",180)(2,"div",181),r(3,"Test Recipients:"),n(),t(4,"div",182),g(5,Rn,2,1,"span",183)(6,Gn,2,1,"span",184),n()(),t(7,"div",132)(8,"button",185),P(9,"async"),_("click",function(){x(e);let a=d(4);return M(a.sendTestEmail())}),t(10,"div",134),g(11,Hn,1,0,"mat-progress-spinner",94),P(12,"async"),t(13,"span"),r(14),P(15,"async"),n()()()(),g(16,Bn,5,1,"div",186),n()}if(i&2){let e=d(4);s(5),l("ngForOf",e.testEmails.slice(0,5)),s(),l("ngIf",e.testEmails.length>5),s(),l("matTooltip",e.getTestEmailTooltip())("matTooltipDisabled",e.canSendTest),s(),l("disabled",!e.canSendTest||S(9,8,e.testEmailLoading$)==="loading"),s(3),l("ngIf",S(12,10,e.testEmailLoading$)==="loading"),s(3),b(S(15,12,e.testEmailLoading$)==="loading"?"Sending...":"Send Test Email"),s(2),l("ngIf",e.testEmailSent)}}function Yn(i,m){i&1&&(t(0,"div",179)(1,"button",190)(2,"div",134),C(),t(3,"svg",6),h(4,"path",76),n(),v(),t(5,"span"),r(6,"Test Email Unavailable"),n()()()())}function Wn(i,m){if(i&1&&(t(0,"div",3)(1,"div",4)(2,"div",5),C(),t(3,"svg",6),h(4,"path",175),n()(),v(),t(5,"div",10)(6,"h3"),r(7,"Test Email"),n(),t(8,"p"),r(9),n()(),t(10,"div",11),r(11,"Step 5"),n()(),g(12,$n,11,0,"div",176)(13,Un,17,14,"div",177)(14,Yn,7,0,"div",177),n()),i&2){let e=d(3);s(9),E("",e.testEmails.length," test recipient(s)"),s(3),l("ngIf",e.testEmails.length===0),s(),l("ngIf",e.testEmails.length>0),s(),l("ngIf",e.testEmails.length===0)}}function qn(i,m){if(i&1&&(t(0,"li")(1,"span",196),r(2),n(),t(3,"span",197),r(4),n()()),i&2){let e=m.$implicit;Be("summary-item-"+e.type),s(2),b(e.icon),s(2),b(e.text)}}function Kn(i,m){if(i&1&&(t(0,"div",191)(1,"div",192),C(),t(2,"svg",6),h(3,"path",174),n(),v(),t(4,"h4"),r(5,"SUBMISSION SUMMARY:"),n()(),t(6,"ul",193),g(7,qn,5,4,"li",194),n(),t(8,"p",195)(9,"strong"),r(10,"Proceed with submission?"),n()()()),i&2){let e=d(3);s(7),l("ngForOf",e.getSubmissionSummary())}}function Jn(i,m){i&1&&h(0,"mat-progress-spinner",198)}function Zn(i,m){i&1&&(t(0,"div",199)(1,"span"),r(2,"\u26A0\uFE0F No test emails available - Campaign will be submitted untested"),n()())}function Xn(i,m){i&1&&(t(0,"div",199)(1,"span"),r(2,"\u26A0\uFE0F Test email not sent - Extra confirmation will be required"),n()())}function Qn(i,m){if(i&1){let e=O();t(0,"div",119)(1,"div",120),C(),t(2,"svg",6),h(3,"circle",37)(4,"polyline",121),n(),v(),t(5,"span"),r(6,"Schedule Summary"),n()(),t(7,"div",122),g(8,kn,9,4,"div",123),n(),g(9,An,3,2,"div",124),t(10,"div",125),g(11,jn,14,1,"div",126),t(12,"div",127)(13,"div",128),g(14,Nn,6,7,"div",129),n()()(),g(15,Wn,15,4,"div",26),t(16,"div",130),g(17,Kn,11,1,"div",131),t(18,"div",132)(19,"button",133),P(20,"async"),_("click",function(){x(e);let a=d(2);return M(a.onSubmit())}),t(21,"div",134),g(22,Jn,1,0,"mat-progress-spinner",135),P(23,"async"),t(24,"span"),r(25),P(26,"async"),n()()()(),g(27,Zn,3,0,"div",136)(28,Xn,3,0,"div",136),n()()}if(i&2){let e=d(2);s(8),l("ngForOf",e.scheduleGroups),s(),l("ngIf",e.timezoneAnalysis),s(2),l("ngIf",e.hasImmediateSends()),s(3),l("ngForOf",e.scheduleGroups),s(),l("ngIf",e.masterData.length),s(2),l("ngIf",e.getSubmissionSummary().length>0),s(),l("matTooltip",e.getSubmitTooltip())("matTooltipDisabled",e.canSubmit),s(),l("disabled",!e.canSubmit||S(20,13,e.submitLoading$)==="loading"),s(3),l("ngIf",S(23,15,e.submitLoading$)==="loading"),s(3),b(S(26,17,e.submitLoading$)==="loading"?"Submitting...":"Submit Campaign"),s(2),l("ngIf",e.testEmails.length===0&&e.masterData.length>0),s(),l("ngIf",!e.testEmailSent&&e.testEmails.length>0)}}function ei(i,m){if(i&1){let e=O();t(0,"div",3)(1,"div",4)(2,"div",5),C(),t(3,"svg",6),h(4,"path",86)(5,"path",87),n()(),v(),t(6,"div",10)(7,"h3"),r(8,"Campaign Details"),n(),t(9,"p"),r(10,"Subject line and additional content"),n()(),t(11,"div",11),r(12,"Step 4"),n()(),t(13,"div",88)(14,"div",89)(15,"div",90)(16,"div",91),C(),t(17,"svg",6),h(18,"path",92),n()(),v(),t(19,"div",10)(20,"h4"),r(21,"AI Subject Line Generator"),n(),t(22,"p"),r(23,"Generate engaging subject lines for your campaign"),n()()(),t(24,"button",93),_("click",function(){x(e);let a=d();return M(a.onGenerateSubjects())}),g(25,bn,1,0,"mat-progress-spinner",94)(26,fn,2,0,"svg",95),t(27,"span"),r(28),n()()(),g(29,Mn,3,3,"div",96),P(30,"async"),g(31,vn,4,0,"div",97),t(32,"div",98)(33,"label",99),r(34," Subject Line "),t(35,"span",100),r(36,"*"),n()(),t(37,"div",101),h(38,"input",102),t(39,"span",103),r(40),n()(),g(41,Pn,2,0,"div",104),n(),g(42,Qn,29,19,"div",105),n()()}if(i&2){let e=d();s(24),l("disabled",e.subjectsLoading),s(),l("ngIf",e.subjectsLoading),s(),l("ngIf",!e.subjectsLoading),s(2),b(e.subjectsLoading?"Generating...":"Generate"),s(),l("ngIf",!e.subjectsLoading&&S(30,10,e.subjects$)),s(2),l("ngIf",e.subjectsLoading),s(7),l("formControl",e.subjectControl),s(2),b(e.getSubjectCharCount()),s(),l("ngIf",e.subjectControl.touched&&e.subjectControl.invalid),s(),l("ngIf",e.scheduleGroups.length)}}var St=(()=>{class i{get isAnyLoading(){return this.audiencesLoadingSubject.value==="loading"||this.uploadLoadingSubject.value==="loading"||this.reconcileLoadingSubject.value==="loading"||this.testEmailLoadingSubject.value==="loading"||this.submitLoadingSubject.value==="loading"}get canSendTest(){return this.testEmails.length>0&&this.subjectControl.valid&&this.testEmailLoadingSubject.value!=="loading"}get canSubmit(){return this.senderSettingsConfigured&&this.subjectControl.valid&&this.reconciliation!==null&&this.scheduleGroups.length>0&&this.submitLoadingSubject.value!=="loading"}ngOnChanges(e){e.templateId&&(this._templateId=this.templateId),e.runId&&(this._runId=this.runId),e.variantNo&&(this._variantNo=this.variantNo),e.templateHtml&&e.templateHtml.currentValue&&this._templateId&&this._runId&&this._variantNo&&this.saveCurrentState()}constructor(e,o,a,c,p,u,f,I){this.campaignService=e,this.cdr=o,this.snackBar=a,this.dialog=c,this.authService=p,this.http=u,this.router=f,this.cacheService=I,this.templateHtml="",this.templateId="",this.runId="",this.variantNo="",this.closeRequested=new He,this.destroy$=new re,this.qa=A(_e),this.ar=A(ce),this.storageService=A(bt),this.currentSelectedSubject=null,this.isInitialized=!1,this._templateId="",this._runId="",this._variantNo="",this.subjectControl=new Ae("",{nonNullable:!0,validators:[ze.required,ze.maxLength(150)]}),this.bodyAdditionControl=new Ae("",{nonNullable:!0}),this.audiencesLoadingSubject=new z("idle"),this.audiencesLoading$=this.audiencesLoadingSubject.asObservable(),this.uploadLoadingSubject=new z("idle"),this.uploadLoading$=this.uploadLoadingSubject.asObservable(),this.reconcileLoadingSubject=new z("idle"),this.reconcileLoading$=this.reconcileLoadingSubject.asObservable(),this.testEmailLoadingSubject=new z("idle"),this.testEmailLoading$=this.testEmailLoadingSubject.asObservable(),this.submitLoadingSubject=new z("idle"),this.submitLoading$=this.submitLoadingSubject.asObservable(),this.subjectsSubject=new z(null),this.subjects$=this.subjectsSubject.asObservable(),this.subjectsLoading=!1,this.subjectsAborted=!1,this.SUBJECTS_TIMEOUT=6e4,this.addNewMembersToAudience=!1,this.audiences=[],this.selectedAudience=null,this.masterData=[],this.reconciliation=null,this.scheduleGroups=[],this.testEmails=[],this.timezoneAnalysis=null,this.ignoredEmails=[],this.testEmailSent=!1,this.testEmailSentAt=null,this.senderSettingsConfigured=!1,this.checkingSenderSettings=!0,this.uploadedFileName="",this.trackByIndex=y=>y}ngOnInit(){this._templateId=this.templateId||this.ar.snapshot.paramMap.get("id")||"",this._runId=this.runId||this.ar.snapshot.paramMap.get("runId")||"",this._variantNo=this.variantNo||this.ar.snapshot.paramMap.get("no")||"",this.checkSenderSettings();let e=setInterval(()=>{this.checkingSenderSettings||(clearInterval(e),this.senderSettingsConfigured&&this.initializeCampaignPage())},100)}initializeCampaignPage(){this.loadSavedData(),this.loadMailchimpAudiences(),this.campaignService.audiences$.pipe(H(this.destroy$)).subscribe(e=>{this.audiences=e,this.cdr.markForCheck()}),this.campaignService.selectedAudience$.pipe(H(this.destroy$)).subscribe(e=>{e&&(this.selectedAudience=e,this.saveCurrentState()),this.cdr.markForCheck()}),this.campaignService.reconciliation$.pipe(H(this.destroy$)).subscribe(e=>{e&&(this.reconciliation=e,this.saveCurrentState()),this.cdr.markForCheck()}),this.campaignService.timezoneAnalysis$.pipe(H(this.destroy$)).subscribe(e=>{e&&(this.timezoneAnalysis=e,this.saveCurrentState()),this.cdr.markForCheck()}),this.subjectControl.valueChanges.pipe(ke(500),H(this.destroy$)).subscribe(e=>{if(!e.trim()&&this.currentSelectedSubject){let a=this.subjectsSubject.value||[];this.subjectsSubject.next([...a,this.currentSelectedSubject]),this.currentSelectedSubject=null,this.cdr.markForCheck()}this.saveCurrentState()}),this.bodyAdditionControl.valueChanges.pipe(ke(500),H(this.destroy$)).subscribe(()=>{this.saveCurrentState()}),setTimeout(()=>{this.isInitialized=!0,this.cdr.markForCheck()},100)}ngOnDestroy(){this.saveCurrentState(),this.destroy$.next(),this.destroy$.complete(),this.subjectsSub&&this.subjectsSub.unsubscribe(),this.subjectsTimeoutId&&clearTimeout(this.subjectsTimeoutId)}loadSavedData(){if(!this._templateId||!this._runId||!this._variantNo)return;let e=this.storageService.getCampaignData(this._templateId,this._runId,this._variantNo);!e||!e.savedAt||(e.subject&&this.subjectControl.setValue(e.subject,{emitEvent:!1}),e.bodyAddition&&this.bodyAdditionControl.setValue(e.bodyAddition,{emitEvent:!1}),e.selectedAudience&&(this.selectedAudience=e.selectedAudience,this.campaignService.selectAudience(e.selectedAudience)),e.masterData&&e.masterData.length>0&&(this.masterData=e.masterData,this.uploadedFileName=e.uploadedFileName||"",this.uploadLoadingSubject.next("success"),(!e.testEmails||e.testEmails.length===0)&&(this.testEmails=this.campaignService.extractTestEmails(e.masterData)),(!e.scheduleGroups||e.scheduleGroups.length===0)&&(this.scheduleGroups=this.campaignService.groupByScheduleTime(e.masterData))),e.reconciliation&&(this.reconciliation=e.reconciliation,this.reconcileLoadingSubject.next("success")),e.scheduleGroups&&e.scheduleGroups.length>0&&(this.scheduleGroups=e.scheduleGroups),e.timezoneAnalysis&&(this.timezoneAnalysis=e.timezoneAnalysis),e.testEmails&&e.testEmails.length>0&&(this.testEmails=e.testEmails),e.generatedSubjects&&e.generatedSubjects.length>0&&this.subjectsSubject.next(e.generatedSubjects),e.testEmailSent&&(this.testEmailSent=e.testEmailSent,this.testEmailSentAt=e.testEmailSentAt?new Date(e.testEmailSentAt):null),e.templateHtml&&!this.templateHtml&&(this.templateHtml=e.templateHtml),this.addNewMembersToAudience=e.addNewMembersToAudience||!1,this.cdr.markForCheck(),setTimeout(()=>{this.cdr.markForCheck()},0))}checkSenderSettings(){this.checkingSenderSettings=!0;let e=this.senderSettingsConfigured;this.authService.currentUser$.pipe(Fe(1)).subscribe(o=>{if(o?.organizationId){let a=typeof o.organizationId=="object"?o.organizationId._id:o.organizationId,c=`sender_settings_${a}`,p=this.cacheService.get(c);if(p){console.log("\u2705 Using cached sender settings"),this.senderSettingsConfigured=p.isConfigured||!1,this.checkingSenderSettings=!1,!e&&this.senderSettingsConfigured&&this.initializeCampaignPage(),this.cdr.markForCheck();return}console.log("\u{1F50D} Fetching sender settings from API"),this.http.get(`/api/organizations/${a}/sender-settings`).subscribe({next:u=>{this.senderSettingsConfigured=u.isConfigured||!1,this.checkingSenderSettings=!1,this.cacheService.set(c,u,30*60*1e3,"session"),!e&&this.senderSettingsConfigured&&this.initializeCampaignPage(),this.cdr.markForCheck()},error:u=>{console.error("Failed to check sender settings:",u),this.checkingSenderSettings=!1,this.senderSettingsConfigured=!1,this.cdr.markForCheck()}})}})}goBackFromBlockedPage(){this.router.navigate(["/qa"],{replaceUrl:!0})}saveCurrentState(){if(!this.isInitialized||!this._templateId||!this._runId||!this._variantNo)return;let e={selectedAudience:this.selectedAudience,masterData:this.masterData,uploadedFileName:this.uploadedFileName,reconciliation:this.reconciliation,addNewMembersToAudience:this.addNewMembersToAudience,scheduleGroups:this.scheduleGroups,timezoneAnalysis:this.timezoneAnalysis,subject:this.subjectControl.value,bodyAddition:this.bodyAdditionControl.value,generatedSubjects:this.subjectsSubject.value||[],testEmails:this.testEmails,testEmailSent:this.testEmailSent,testEmailSentAt:this.testEmailSentAt?.toISOString()||null,templateHtml:this.templateHtml,templateId:this._templateId,runId:this._runId,variantNo:this._variantNo,savedAt:new Date().toISOString()};this.storageService.saveCampaignData(this._templateId,this._runId,this._variantNo,e)}clearSavedData(){!this._templateId||!this._runId||!this._variantNo||this.storageService.clearCampaignData(this._templateId,this._runId,this._variantNo)}onGenerateSubjects(){return R(this,null,function*(){let e=this.ar.snapshot.paramMap.get("id");if(!e){this.showError("Template ID not found");return}if(this.subjectsLoading)return;this.subjectsSubject.next(null),this.subjectsLoading=!0,this.subjectsAborted=!1,this.cdr.markForCheck(),this.subjectsTimeoutId=window.setTimeout(()=>{this.handleSubjectsTimeout()},this.SUBJECTS_TIMEOUT);let o=this.templateHtml||"";this.subjectsSub=this.qa.generateSubjects(e,o,!0).pipe(Le(this.SUBJECTS_TIMEOUT),Ne({count:2,delay:2e3,resetOnSuccess:!0}),D(a=>{throw a.name==="TimeoutError"?new Error("Subject generation timed out. Please try again."):a})).subscribe({next:a=>{this.subjectsAborted||(this.subjectsTimeoutId&&(clearTimeout(this.subjectsTimeoutId),this.subjectsTimeoutId=void 0),this.subjectsLoading=!1,this.subjectsSubject.next(a),this.saveCurrentState(),this.showSuccess(`Generated ${a.length} subject line suggestion${a.length>1?"s":""}!`),this.cdr.markForCheck())},error:a=>{if(this.subjectsAborted)return;this.subjectsTimeoutId&&(clearTimeout(this.subjectsTimeoutId),this.subjectsTimeoutId=void 0),this.subjectsLoading=!1,this.subjectsAborted=!0,this.subjectsSubject.next(null);let c=this.getErrorMessage(a,"subject generation");this.showError(c),this.cdr.markForCheck()},complete:()=>{this.subjectsAborted||this.cdr.markForCheck()}})})}handleSubjectsTimeout(){this.subjectsLoading=!1,this.subjectsAborted=!0,this.showError("Subject generation is taking longer than expected. Please try again."),this.cdr.markForCheck()}cancelSubjects(){this.subjectsLoading&&(this.subjectsAborted=!0,this.subjectsLoading=!1,this.subjectsSub&&(this.subjectsSub.unsubscribe(),this.subjectsSub=void 0),this.subjectsTimeoutId&&(clearTimeout(this.subjectsTimeoutId),this.subjectsTimeoutId=void 0),this.showError("Subject generation cancelled."),this.cdr.markForCheck())}onSelectSubject(e){let o=this.subjectsSubject.value||[],a=this.subjectControl.value.trim();if(a===e)return;let c=o.indexOf(e);if(c===-1)return;let p=[...o];a?p[c]=a:p.splice(c,1),this.currentSelectedSubject=e,this.subjectControl.setValue(e),this.subjectsSubject.next(p),this.saveCurrentState(),this.cdr.markForCheck(),this.showSuccess("Subject line selected!")}isSubjectSelected(e){return this.subjectControl.value.trim()===e}getErrorMessage(e,o){return e?.message?.includes("timeout")||e?.name==="TimeoutError"?`${o} timed out. The server might be busy. Please try again.`:e?.status===0||e?.message?.includes("Http failure")?"Cannot connect to server. Please check if the backend is running.":e?.status===500?`Server error during ${o}. Please try again.`:e?.status===404?"Resource not found. Please refresh the page.":e?.message||`An error occurred during ${o}. Please try again.`}loadMailchimpAudiences(){return R(this,null,function*(){this.audiencesLoadingSubject.next("loading");try{yield j(this.campaignService.fetchMailchimpAudiences()),this.audiencesLoadingSubject.next("success")}catch{this.audiencesLoadingSubject.next("error"),this.showError("Failed to load Mailchimp audiences")}})}selectAudience(e){this.campaignService.selectAudience(e)}onFileUpload(e){return R(this,null,function*(){let o=e.target,a=o?.files?.[0];if(a){this.uploadedFileName=a.name,this.uploadLoadingSubject.next("loading");try{let c=yield j(this.authService.currentUser$),p=typeof c?.organizationId=="string"?c.organizationId:c?.organizationId?._id,u=typeof c?.organizationId=="object"?c?.organizationId?.name:void 0;if(!p){this.showError("User not associated with an organization"),this.uploadLoadingSubject.next("error");return}let f=this.dialog.open(Pt,{width:"1000px",maxWidth:"95vw",data:{csvFile:a,organizationId:p,organizationName:u},disableClose:!0}),I=yield j(f.afterClosed());if(!I?.validated){this.uploadLoadingSubject.next("idle"),o.value="";return}let y=I.addedToMaster||[],w=I.scheduledEmails||[],B=I.result,De=B?.excludedFromCampaign?.subscribers||[];this.ignoredEmails=De.filter(we=>!y.includes(we)),console.log("\u{1F4CA} Validation Summary:"),console.log(`  - Total excluded: ${De.length}`),console.log(`  - Added to master: ${y.length}`),console.log(`  - Ignored: ${this.ignoredEmails.length}`);let Q=yield j(this.campaignService.uploadMasterDocument(a));if(y.length>0){let we=new Map(w.map(U=>[U.email,U]));y.forEach(U=>{let ee=we.get(U);console.log("\u{1F50D} Adding excluded email to master:",{email:U,scheduleInfo:ee,hasTime:!!ee?.time,hasTimezone:!!ee?.timezone});let yt={audiences_list:U,scheduled_time:ee?.time||"",timezone:ee?.timezone||"",test_emails:""};Q.push(yt)}),console.log(`\u{1F4E7} Added ${y.length} excluded emails to master document`),this.showSuccess(`${y.length} excluded subscribers added to campaign`)}this.masterData=Q,this.uploadLoadingSubject.next("success"),this.testEmails=this.campaignService.extractTestEmails(Q),this.scheduleGroups=this.campaignService.groupByScheduleTime(Q),this.showSuccess(`Uploaded ${Q.length} total recipients (${B?.summary?.totalInCsv||0} from CSV + ${y.length} added)`),this.saveCurrentState(),this.selectedAudience&&(yield this.reconcileAudiences())}catch(c){console.error("Upload error:",c),this.uploadLoadingSubject.next("error"),this.showError("Failed to upload file. Check format.")}finally{o.value=""}}})}reconcileAudiences(){return R(this,null,function*(){if(!this.selectedAudience||!this.masterData.length){this.showError("Select audience and upload file first");return}this.reconcileLoadingSubject.next("loading");try{let e=this.masterData.map(a=>a.audiences_list?.trim()).filter(Boolean),o=yield j(this.campaignService.reconcileAudiences(this.selectedAudience.id,e));o.ignored=this.ignoredEmails,o.summary.ignoredCount=this.ignoredEmails.length,this.reconciliation=o,this.reconcileLoadingSubject.next("success"),this.cdr.markForCheck(),this.saveCurrentState()}catch{this.reconcileLoadingSubject.next("error"),this.showError("Failed to reconcile audiences")}})}sendTestEmail(){return R(this,null,function*(){if(!this.canSendTest){this.showError("Add subject and ensure test emails exist");return}if(confirm(`Send test email to ${this.testEmails.length} recipient(s)?

${this.testEmails.slice(0,5).join(`
`)}${this.testEmails.length>5?`
...`:""}`)){this.testEmailLoadingSubject.next("loading");try{let o=this.subjectControl.value,a=this.templateHtml;this.bodyAdditionControl.value.trim()&&(a+=`

<!-- Additional Content -->
${this.bodyAdditionControl.value}`);let c=yield j(this.campaignService.sendTestEmails(this.testEmails,o,a));this.testEmailLoadingSubject.next("success"),this.testEmailSent=!0,this.testEmailSentAt=new Date,this.saveCurrentState(),c.failed.length>0?this.showError(`Sent ${c.sent}, failed ${c.failed.length}`):this.showSuccess(`Test email sent to ${c.sent} recipient(s)`)}catch{this.testEmailLoadingSubject.next("error"),this.showError("Failed to send test emails")}}})}getSubmissionSummary(){if(!this.reconciliation||!this.subjectControl.valid||this.scheduleGroups.length===0)return[];let e=[],o=this.hasImmediateSends(),a=this.getImmediateSendCount(),c=this.shouldShowTimezoneWarning(),p=this.reconciliation&&this.reconciliation.summary.newCount>0;return o&&e.push({icon:"\u26A1",text:`${a} email(s) will be sent IMMEDIATELY`,type:"immediate"}),c&&e.push({icon:"\u{1F30D}",text:this.getTimezoneWarningMessage(),type:"timezone"}),p&&(this.addNewMembersToAudience?e.push({icon:"\u{1F4CB}",text:`${this.reconciliation.summary.newCount} new member(s) will be archived after sending`,type:"member"}):e.push({icon:"\u{1F4CB}",text:`${this.reconciliation.summary.newCount} new member(s) will be archived after sending`,type:"member"})),e}onSubmit(){return R(this,null,function*(){if(!this.canSubmit){this.showError("Complete all steps before submitting");return}let e=this.testEmails.length===0,o=this.reconciliation&&this.reconciliation.summary.newCount>0;if(e&&!confirm(`\u{1F6A8} CRITICAL WARNING \u{1F6A8}

\u274C NO TEST EMAILS FOUND
\u{1F534} Click OK ONLY if you accept full responsibility.`))return;let a=this.scheduleGroups.reduce((c,p)=>c+p.count,0);if(confirm(`\u{1F680} Proceed with submission?

This will send to ${a} recipient(s) and cannot be undone.`)){this.submitLoadingSubject.next("loading");try{if(o&&this.selectedAudience){let I=yield j(this.campaignService.addNewMembersToAudience(this.selectedAudience.id,this.reconciliation.new))}let c=this.subjectControl.value,p=this.templateHtml;this.bodyAdditionControl.value.trim()&&(p+=`

<!-- Additional Content -->
${this.bodyAdditionControl.value}`);let u=yield j(this.campaignService.submitCampaign({subject:c,bodyAddition:this.bodyAdditionControl.value||void 0,templateHtml:p,scheduleGroups:this.scheduleGroups,testEmails:this.testEmails,timezoneAnalysis:this.timezoneAnalysis}));o&&!this.addNewMembersToAudience&&this.selectedAudience&&(yield j(this.campaignService.cleanupTempMembers(this.selectedAudience.id,this.reconciliation.new))),this.submitLoadingSubject.next("success"),this.clearSavedData();let f="";u.message&&u.message.includes("sent immediately")?f="\u26A0\uFE0F Campaign sent immediately! (Scheduling not available on your Mailchimp plan)":f=this.addNewMembersToAudience?`\u2705 Campaign submitted! ${u.campaignIds.length} campaign(s) scheduled.`:`\u2705 Campaign submitted! ${u.campaignIds.length} campaign(s) scheduled. New members will be archived.`,this.showSuccess(f)}catch(c){console.error("Campaign submission error:",c),console.error("Error structure:",JSON.stringify(c,null,2)),this.submitLoadingSubject.next("error");let p="Campaign submission failed. Please try again.",u=c?.error||c,f=u?.errors||[];if(Array.isArray(f)&&f.length>0){let I=f,y=I.find(w=>w.field==="schedule_time");y?y.message.includes("must be in the future")?p="\u23F0 Scheduled time must be in the future. Please update your schedule times and try again.":p=`\u23F0 Invalid schedule time: ${y.message}`:I.some(w=>w.field?.toLowerCase().includes("email")||w.message?.toLowerCase().includes("email")||w.message?.toLowerCase().includes("invalid address"))?p="\u{1F4E7} Invalid email address detected. Please check your email list and ensure all addresses are valid.":I.some(w=>w.field?.toLowerCase().includes("recipient")||w.field?.toLowerCase().includes("list"))?p="\u{1F465} Invalid recipient list. Please verify your audience and try again.":p="\u274C "+I.map(w=>w.message||`Invalid ${w.field}`).join(". ")}else u?.detail?p=u.detail.replace(/Mailchimp/gi,"Email service").replace(/API/gi,"service"):u?.message?p=u.message.replace(/Mailchimp/gi,"Email service").replace(/API/gi,"service"):c?.message&&(p=c.message.replace(/Mailchimp/gi,"Email service").replace(/API/gi,"service"));this.showError(p)}}})}getTestEmailTooltip(){return this.testEmails.length===0?"No test emails found in uploaded file":!this.subjectControl.valid||!this.subjectControl.value.trim()?"Add subject line first":this.testEmailLoadingSubject.value==="loading"?"Sending test email...":"Send test email to recipient(s)"}hasImmediateSends(){return this.scheduleGroups.some(e=>e.isImmediate)}getImmediateSendCount(){return this.scheduleGroups.find(o=>o.isImmediate)?.count||0}getSubmitTooltip(){return!this.subjectControl.valid||!this.subjectControl.value.trim()?"Add subject line first":this.reconciliation?this.scheduleGroups.length===0?"No scheduled recipients found":this.submitLoadingSubject.value==="loading"?"Submitting campaign...":"Submit campaign to Mailchimp":"Upload and reconcile audience data first"}getTimezoneWarningMessage(){if(!this.timezoneAnalysis)return"";let e=this.timezoneAnalysis;return!e.hasTimezoneColumn||e.timezoneMode==="none"?`No timezone specified. All emails will be scheduled in your local timezone (${this.getBrowserTimezone()})`:e.timezoneMode==="single"?`All emails will be sent in timezone: ${e.uniqueTimezones[0]}`:e.timezoneMode==="multiple"?`Using per-customer timezones (${e.uniqueTimezones.length} different zones)`:e.timezoneMode==="mixed"?`${e.emptyTimezoneCount} email(s) missing timezone will use local time (${this.getBrowserTimezone()})`:""}getBrowserTimezone(){return Intl.DateTimeFormat().resolvedOptions().timeZone}shouldShowTimezoneWarning(){return this.timezoneAnalysis?!this.timezoneAnalysis.hasTimezoneColumn||this.timezoneAnalysis.timezoneMode==="none"||this.timezoneAnalysis.timezoneMode==="mixed":!1}shouldShowTimezoneInfo(){return this.timezoneAnalysis?this.timezoneAnalysis.timezoneMode==="single"||this.timezoneAnalysis.timezoneMode==="multiple":!1}showSuccess(e){this.snackBar.open(e,"Close",{duration:3e3,panelClass:["success-snackbar"],horizontalPosition:"center",verticalPosition:"bottom"})}showError(e){this.snackBar.open(e,"Close",{duration:5e3,panelClass:["error-snackbar"],horizontalPosition:"center",verticalPosition:"bottom"})}getSubjectCharCount(){return`${this.subjectControl.value.length}/150`}getTestEmailsSentTime(){if(!this.testEmailSentAt)return"";let o=Math.floor((new Date().getTime()-this.testEmailSentAt.getTime())/1e3/60);if(o<1)return"Just now";if(o===1)return"1 min ago";if(o<60)return`${o} mins ago`;let a=Math.floor(o/60);return a===1?"1 hour ago":`${a} hours ago`}static{this.\u0275fac=function(o){return new(o||i)(k(Ot),k(Ye),k(gt),k(ve),k(ut),k(K),k(le),k(pt))}}static{this.\u0275cmp=V({type:i,selectors:[["app-campaign-submit"]],inputs:{templateHtml:"templateHtml",templateId:"templateId",runId:"runId",variantNo:"variantNo"},outputs:{closeRequested:"closeRequested"},standalone:!0,features:[Ge,L],decls:56,vars:31,consts:[[1,"campaign-submit-wrapper"],["class","blocking-overlay",4,"ngIf"],[1,"content-wrapper"],[1,"section-card"],[1,"card-header"],[1,"header-icon"],["viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2"],["d","M17 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2"],["cx","9","cy","7","r","4"],["d","M23 21v-2a4 4 0 00-3-3.87m-4-12a4 4 0 010 7.75"],[1,"header-text"],[1,"step-badge"],["class","loading-state",4,"ngIf"],["class","error-state",4,"ngIf"],["class","audience-list",4,"ngIf"],["class","empty-state",4,"ngIf"],["d","M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"],[1,"upload-box"],["type","file","accept",".csv,.xlsx,.xls","hidden","",3,"change","disabled"],["d","M13 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V9z"],["points","13 2 13 9 20 9"],[1,"upload-text"],[1,"primary"],["diameter","24","mode","indeterminate",4,"ngIf"],["class","upload-status",4,"ngIf"],["class","upload-error",4,"ngIf"],["class","section-card",4,"ngIf"],["class","add-members-section",4,"ngIf"],[1,"blocking-overlay"],[1,"blocking-modal"],["class","checking-state",4,"ngIf"],["class","not-configured-state",4,"ngIf"],[1,"checking-state"],["diameter","48"],[1,"checking-message"],[1,"not-configured-state"],[1,"modal-icon"],["cx","12","cy","12","r","10"],["x1","12","y1","8","x2","12","y2","12"],["x1","12","y1","16","x2","12.01","y2","16"],[1,"modal-message"],[1,"modal-instructions"],[1,"modal-actions"],["mat-raised-button","","color","primary",3,"click"],["mat-button","",3,"click"],[1,"loading-state"],["diameter","32","mode","indeterminate"],[1,"error-state"],[1,"audience-list"],["class","audience-item",3,"selected","click",4,"ngFor","ngForOf"],[1,"audience-item",3,"click"],[1,"audience-info"],[1,"audience-name"],[1,"audience-count"],["class","check-icon",4,"ngIf"],[1,"check-icon"],["d","M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"empty-state"],["diameter","24","mode","indeterminate"],[1,"upload-status"],[1,"status-success"],[1,"status-text"],[1,"upload-error"],["x1","15","y1","9","x2","9","y2","15"],["x1","9","y1","9","x2","15","y2","15"],["class","reconcile-results",4,"ngIf"],[1,"reconcile-results"],[1,"result-grid"],[1,"result-item","existing"],[1,"result-icon"],[1,"result-content"],[1,"result-count"],[1,"result-label"],[1,"result-item","new"],["d","M12 4v16m8-8H4"],[1,"result-item","ignored"],["d","M18 6L6 18M6 6l12 12"],[1,"add-members-section"],[1,"toggle-container"],["type","checkbox","id","addNewMembers",1,"toggle-checkbox",3,"ngModelChange","ngModel"],["for","addNewMembers",1,"toggle-label"],["d","M16 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2"],["cx","8.5","cy","7","r","4"],["x1","20","y1","8","x2","20","y2","14"],["x1","23","y1","11","x2","17","y2","11"],[1,"toggle-hint"],["d","M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7"],["d","M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4 9.5-9.5z"],[1,"subject-generator-section"],[1,"generator-header"],[1,"header-content"],[1,"icon-wrapper"],["d","M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"],[1,"generate-subjects-btn",3,"click","disabled"],["diameter","18","mode","indeterminate",4,"ngIf"],["viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2",4,"ngIf"],["class","subjects-grid",4,"ngIf"],["class","subjects-loading",4,"ngIf"],[1,"input-group"],[1,"input-label"],[1,"required"],[1,"input-wrapper"],["type","text","placeholder","Enter email subject...","maxlength","150",1,"text-input",3,"formControl"],[1,"char-count"],["class","input-error",4,"ngIf"],["class","schedule-preview",4,"ngIf"],["diameter","18","mode","indeterminate"],["d","M13 10V3L4 14h7v7l9-11h-7z"],[1,"subjects-grid"],["class","subject-chip",3,"selected","click",4,"ngFor","ngForOf","ngForTrackBy"],["class","empty-subjects",4,"ngIf"],[1,"subject-chip",3,"click"],[1,"chip-content"],[1,"chip-text"],[1,"chip-icon"],["d","M9 5l7 7-7 7"],[1,"empty-subjects"],[1,"subjects-loading"],[1,"input-error"],[1,"schedule-preview"],[1,"preview-header"],["points","12 6 12 12 16 14"],[1,"schedule-summary-box"],["class","summary-item",4,"ngFor","ngForOf"],["class","timezone-info-banner","style","display: none;",4,"ngIf"],[2,"display","none"],["class","immediate-warning",4,"ngIf"],[1,"schedule-list-container"],[1,"schedule-list"],["class","schedule-item",3,"immediate","local-timezone",4,"ngFor","ngForOf"],[1,"submit-section"],["class","submission-summary-banner",4,"ngIf"],["matTooltipPosition","above","matTooltipShowDelay","300",1,"button-wrapper",3,"matTooltip","matTooltipDisabled"],["mat-raised-button","",1,"submit-btn",3,"click","disabled"],[1,"button-content"],["diameter","20","mode","indeterminate",4,"ngIf"],["class","warning-banner",4,"ngIf"],[1,"summary-item"],[1,"summary-count"],[1,"count-badge"],[1,"count-label"],[1,"summary-details"],[4,"ngIf"],[1,"summary-time","immediate"],[1,"summary-note"],[1,"summary-time"],["class","summary-timezone",4,"ngIf"],["class","summary-timezone warning",4,"ngIf"],[1,"summary-timezone"],["class","timezone-badge",4,"ngIf"],["class","timezone-badge local",4,"ngIf"],[1,"timezone-badge"],[1,"timezone-badge","local"],[1,"summary-timezone","warning"],[1,"timezone-info-banner",2,"display","none"],["class","timezone-warning",4,"ngIf"],["class","timezone-info",4,"ngIf"],[1,"timezone-warning"],[1,"warning-content"],[1,"timezone-info"],["d","M12 16v-4m0-4h.01"],[1,"info-content"],[1,"immediate-warning"],["d","M13 2L3 14h9l-1 8 10-12h-9l1-8z"],[1,"warning-text"],[1,"schedule-item"],[1,"schedule-time"],[1,"schedule-count"],[1,"time-with-zone"],[1,"time"],["class","zone",4,"ngIf"],["class","zone local-indicator",4,"ngIf"],[1,"zone"],[1,"zone","local-indicator"],["d","M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"],["d","M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"],["class","no-test-emails-warning",4,"ngIf"],["class","test-email-section",4,"ngIf"],[1,"no-test-emails-warning"],[1,"test-email-section"],[1,"test-emails-preview"],[1,"preview-label"],[1,"email-chips"],["class","email-chip",4,"ngFor","ngForOf"],["class","email-chip more",4,"ngIf"],["mat-raised-button","",1,"test-email-btn",3,"click","disabled"],["class","test-status",4,"ngIf"],[1,"email-chip"],[1,"email-chip","more"],[1,"test-status"],["mat-raised-button","","disabled","","matTooltip","No test emails found in uploaded file",1,"test-email-btn","disabled"],[1,"submission-summary-banner"],[1,"summary-header"],[1,"summary-list"],[3,"class",4,"ngFor","ngForOf"],[1,"summary-footer"],[1,"item-icon"],[1,"item-text"],["diameter","20","mode","indeterminate"],[1,"warning-banner"]],template:function(o,a){o&1&&(t(0,"div",0),g(1,nn,4,2,"div",1),t(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5),C(),t(6,"svg",6),h(7,"path",7)(8,"circle",8)(9,"path",9),n()(),v(),t(10,"div",10)(11,"h3"),r(12,"Select Audience"),n(),t(13,"p"),r(14,"Choose your Mailchimp audience list"),n()(),t(15,"div",11),r(16,"Step 1"),n()(),g(17,an,4,0,"div",12),P(18,"async"),g(19,on,9,0,"div",13),P(20,"async"),g(21,cn,2,1,"div",14),P(22,"async"),g(23,ln,9,0,"div",15),P(24,"async"),n(),t(25,"div",3)(26,"div",4)(27,"div",5),C(),t(28,"svg",6),h(29,"path",16),n()(),v(),t(30,"div",10)(31,"h3"),r(32,"Upload Master Document"),n(),t(33,"p"),r(34,"CSV/Excel with: audiences_list, scheduled_time, test_emails, and timezones"),n()(),t(35,"div",11),r(36,"Step 2"),n()(),t(37,"label",17)(38,"input",18),_("change",function(p){return a.onFileUpload(p)}),n(),C(),t(39,"svg",6),h(40,"path",19)(41,"polyline",20),n(),v(),t(42,"div",21)(43,"span",22),r(44),n(),t(45,"small"),r(46,"Supports CSV, Excel (.xlsx, .xls)"),n()(),g(47,mn,1,0,"mat-progress-spinner",23),P(48,"async"),n(),g(49,dn,10,5,"div",24),P(50,"async"),g(51,gn,7,0,"div",25),P(52,"async"),n(),g(53,hn,16,6,"div",26)(54,_n,13,1,"div",27)(55,ei,43,12,"div",26),n()()),o&2&&(s(),l("ngIf",!a.senderSettingsConfigured),s(),T("disabled",!a.senderSettingsConfigured),s(15),l("ngIf",S(18,17,a.audiencesLoading$)==="loading"),s(2),l("ngIf",S(20,19,a.audiencesLoading$)==="error"),s(2),l("ngIf",S(22,21,a.audiencesLoading$)==="success"&&a.audiences.length),s(2),l("ngIf",S(24,23,a.audiencesLoading$)==="success"&&!a.audiences.length),s(14),T("disabled",!a.selectedAudience),s(),l("disabled",!a.selectedAudience),s(6),b(a.uploadedFileName||"Click to upload"),s(3),l("ngIf",S(48,25,a.uploadLoading$)==="loading"),s(2),l("ngIf",S(50,27,a.uploadLoading$)==="success"&&a.masterData.length),s(2),l("ngIf",S(52,29,a.uploadLoading$)==="error"),s(2),l("ngIf",a.reconciliation),s(),l("ngIf",a.reconciliation&&a.reconciliation.summary.newCount>0),s(),l("ngIf",a.masterData.length))},dependencies:[F,W,q,Ke,Ze,Je,at,me,Xe,de,it,et,pe,ge,N,J,$,Z,he,ue,Ce,fe],styles:['.campaign-submit-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem;padding:1rem;max-height:calc(85vh - 180px);overflow-y:auto;overflow-x:hidden}.campaign-submit-wrapper[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.campaign-submit-wrapper[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#ffffff0d}.campaign-submit-wrapper[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#fff3;border-radius:3px}.campaign-submit-wrapper[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#ffffff4d}@media (max-width: 768px){.campaign-submit-wrapper[_ngcontent-%COMP%]{padding:1.25rem;gap:1rem}}.blocking-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#000000d9;-webkit-backdrop-filter:blur(8px);backdrop-filter:blur(8px);display:flex;align-items:center;justify-content:center;z-index:9999;animation:_ngcontent-%COMP%_fadeIn .3s ease-out}.blocking-overlay[_ngcontent-%COMP%]   .blocking-modal[_ngcontent-%COMP%]{background:#fff;border-radius:16px;padding:2.5rem;max-width:600px;width:90%;box-shadow:0 20px 60px #0000004d;animation:_ngcontent-%COMP%_slideUp .3s ease-out}.blocking-overlay[_ngcontent-%COMP%]   .blocking-modal[_ngcontent-%COMP%]   .checking-state[_ngcontent-%COMP%]{text-align:center;padding:2rem 0}.blocking-overlay[_ngcontent-%COMP%]   .blocking-modal[_ngcontent-%COMP%]   .checking-state[_ngcontent-%COMP%]   mat-spinner[_ngcontent-%COMP%]{margin:0 auto 1.5rem}.blocking-overlay[_ngcontent-%COMP%]   .blocking-modal[_ngcontent-%COMP%]   .checking-state[_ngcontent-%COMP%]   .checking-message[_ngcontent-%COMP%]{font-size:1.125rem;color:#475569;font-weight:500;margin:0}.blocking-overlay[_ngcontent-%COMP%]   .blocking-modal[_ngcontent-%COMP%]   .not-configured-state[_ngcontent-%COMP%]   .modal-icon[_ngcontent-%COMP%]{text-align:center;margin-bottom:1.5rem}.blocking-overlay[_ngcontent-%COMP%]   .blocking-modal[_ngcontent-%COMP%]   .not-configured-state[_ngcontent-%COMP%]   .modal-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:4rem;height:4rem;color:#f59e0b;stroke-width:2.5}.blocking-overlay[_ngcontent-%COMP%]   .blocking-modal[_ngcontent-%COMP%]   .not-configured-state[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{text-align:center;font-size:1.75rem;font-weight:700;color:#1e293b;margin:0 0 1rem}.blocking-overlay[_ngcontent-%COMP%]   .blocking-modal[_ngcontent-%COMP%]   .not-configured-state[_ngcontent-%COMP%]   .modal-message[_ngcontent-%COMP%]{text-align:center;font-size:1.125rem;color:#475569;line-height:1.6;margin:0 0 2rem}.blocking-overlay[_ngcontent-%COMP%]   .blocking-modal[_ngcontent-%COMP%]   .not-configured-state[_ngcontent-%COMP%]   .modal-message[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#1e293b;font-weight:600}.blocking-overlay[_ngcontent-%COMP%]   .blocking-modal[_ngcontent-%COMP%]   .not-configured-state[_ngcontent-%COMP%]   .modal-instructions[_ngcontent-%COMP%]{background:#f8fafc;border-left:4px solid #667eea;border-radius:8px;padding:1.5rem;margin-bottom:2rem}.blocking-overlay[_ngcontent-%COMP%]   .blocking-modal[_ngcontent-%COMP%]   .not-configured-state[_ngcontent-%COMP%]   .modal-instructions[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1rem;font-weight:700;color:#1e293b;margin:0 0 1rem}.blocking-overlay[_ngcontent-%COMP%]   .blocking-modal[_ngcontent-%COMP%]   .not-configured-state[_ngcontent-%COMP%]   .modal-instructions[_ngcontent-%COMP%]   ol[_ngcontent-%COMP%]{margin:0;padding-left:1.5rem;color:#475569}.blocking-overlay[_ngcontent-%COMP%]   .blocking-modal[_ngcontent-%COMP%]   .not-configured-state[_ngcontent-%COMP%]   .modal-instructions[_ngcontent-%COMP%]   ol[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:.75rem;line-height:1.5}.blocking-overlay[_ngcontent-%COMP%]   .blocking-modal[_ngcontent-%COMP%]   .not-configured-state[_ngcontent-%COMP%]   .modal-instructions[_ngcontent-%COMP%]   ol[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:last-child{margin-bottom:0}.blocking-overlay[_ngcontent-%COMP%]   .blocking-modal[_ngcontent-%COMP%]   .not-configured-state[_ngcontent-%COMP%]   .modal-instructions[_ngcontent-%COMP%]   ol[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#1e293b;font-weight:600}.blocking-overlay[_ngcontent-%COMP%]   .blocking-modal[_ngcontent-%COMP%]   .not-configured-state[_ngcontent-%COMP%]   .modal-actions[_ngcontent-%COMP%]{display:flex;gap:1rem;justify-content:center}.blocking-overlay[_ngcontent-%COMP%]   .blocking-modal[_ngcontent-%COMP%]   .not-configured-state[_ngcontent-%COMP%]   .modal-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:140px;height:48px;font-weight:600}.blocking-overlay[_ngcontent-%COMP%]   .blocking-modal[_ngcontent-%COMP%]   .not-configured-state[_ngcontent-%COMP%]   .modal-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:.5rem}.content-wrapper.disabled[_ngcontent-%COMP%]{pointer-events:none;opacity:.3;filter:blur(2px)}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}@keyframes _ngcontent-%COMP%_slideUp{0%{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}.warning-banner[_ngcontent-%COMP%]{background:linear-gradient(135deg,#fef3c7,#fde68a);border:2px solid #f59e0b;border-radius:12px;padding:1.5rem;display:flex;gap:1rem;align-items:flex-start;box-shadow:0 4px 12px #f59e0b33;animation:_ngcontent-%COMP%_slideDown .3s ease-out}.warning-banner[_ngcontent-%COMP%]   .warning-icon[_ngcontent-%COMP%]{flex-shrink:0;color:#f59e0b}.warning-banner[_ngcontent-%COMP%]   .warning-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:2rem;height:2rem}.warning-banner[_ngcontent-%COMP%]   .warning-content[_ngcontent-%COMP%]{flex:1}.warning-banner[_ngcontent-%COMP%]   .warning-content[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 .5rem;color:#92400e;font-size:1.125rem;font-weight:700}.warning-banner[_ngcontent-%COMP%]   .warning-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#78350f;line-height:1.6}.warning-banner[_ngcontent-%COMP%]   .warning-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#92400e;font-weight:600}@keyframes _ngcontent-%COMP%_slideDown{0%{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}.section-card[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:1.5rem;box-shadow:0 2px 8px #0000001a;transition:box-shadow .2s ease}.section-card[_ngcontent-%COMP%]:hover{box-shadow:0 4px 16px #0000001f}@media (max-width: 768px){.section-card[_ngcontent-%COMP%]{padding:1.25rem}}.card-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;margin-bottom:1.25rem;padding-bottom:1rem;border-bottom:1px solid #e5e7eb}.card-header[_ngcontent-%COMP%]   .header-icon[_ngcontent-%COMP%]{width:40px;height:40px;background:#f3f4f6;border-radius:8px;display:flex;align-items:center;justify-content:center;flex-shrink:0}.card-header[_ngcontent-%COMP%]   .header-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:20px;height:20px;color:#6b7280}.card-header[_ngcontent-%COMP%]   .header-text[_ngcontent-%COMP%]{flex:1}.card-header[_ngcontent-%COMP%]   .header-text[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:1.125rem;font-weight:600;color:#111827;line-height:1.3}.card-header[_ngcontent-%COMP%]   .header-text[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:.25rem 0 0;font-size:.875rem;color:#6b7280;line-height:1.4}.card-header[_ngcontent-%COMP%]   .step-badge[_ngcontent-%COMP%]{padding:.375rem .875rem;background:#f3f4f6;border-radius:6px;font-size:.75rem;font-weight:600;color:#6b7280;text-transform:uppercase;letter-spacing:.05em}.loading-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:2.5rem 1.5rem;gap:1rem}.loading-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:.875rem;color:#6b7280}.error-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:2rem 1.5rem;gap:1rem;background:#fef2f2;border:1px solid #fecaca;border-radius:8px}.error-state[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:40px;height:40px;color:#ef4444}.error-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:.875rem;color:#991b1b;text-align:center}.audience-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.75rem;max-height:400px;overflow-y:auto;padding-right:.5rem}.audience-list[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.audience-list[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#0000000d;border-radius:3px}.audience-list[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#6d28d94d;border-radius:3px}.audience-list[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#6d28d980}.audience-item[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:1rem 1.25rem;background:#f9fafb;border:2px solid transparent;border-radius:8px;cursor:pointer;transition:all .2s ease}.audience-item[_ngcontent-%COMP%]:hover{background:#f3f4f6;border-color:#d1d5db}.audience-item.selected[_ngcontent-%COMP%]{background:#ecfdf5;border-color:#10b981}.audience-item.selected[_ngcontent-%COMP%]   .audience-name[_ngcontent-%COMP%]{color:#059669;font-weight:600}.audience-item[_ngcontent-%COMP%]   .audience-info[_ngcontent-%COMP%]{flex:1}.audience-item[_ngcontent-%COMP%]   .audience-name[_ngcontent-%COMP%]{font-size:.9375rem;font-weight:500;color:#111827;margin-bottom:.25rem}.audience-item[_ngcontent-%COMP%]   .audience-count[_ngcontent-%COMP%]{font-size:.8125rem;color:#6b7280}.audience-item[_ngcontent-%COMP%]   .check-icon[_ngcontent-%COMP%]{width:20px;height:20px}.audience-item[_ngcontent-%COMP%]   .check-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:100%;height:100%;color:#10b981}.upload-box[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:2.5rem 2rem;background:#f9fafb;border:2px dashed #d1d5db;border-radius:8px;cursor:pointer;transition:all .2s ease;gap:1rem}.upload-box[_ngcontent-%COMP%]:hover:not(.disabled){background:#f3f4f6;border-color:#9ca3af}.upload-box.disabled[_ngcontent-%COMP%]{opacity:.5;cursor:not-allowed}.upload-box[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:40px;height:40px;color:#9ca3af}.upload-box[_ngcontent-%COMP%]   .upload-text[_ngcontent-%COMP%]{text-align:center}.upload-box[_ngcontent-%COMP%]   .upload-text[_ngcontent-%COMP%]   .primary[_ngcontent-%COMP%]{display:block;font-size:.9375rem;font-weight:500;color:#111827;margin-bottom:.25rem}.upload-box[_ngcontent-%COMP%]   .upload-text[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{font-size:.8125rem;color:#6b7280}.upload-status[_ngcontent-%COMP%]{margin-top:1rem}.status-success[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;padding:1rem;background:#ecfdf5;border:1px solid #a7f3d0;border-radius:8px}.status-success[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:20px;height:20px;color:#10b981;flex-shrink:0}.status-success[_ngcontent-%COMP%]   .status-text[_ngcontent-%COMP%]{flex:1}.status-success[_ngcontent-%COMP%]   .status-text[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{display:block;font-size:.875rem;color:#065f46;margin-bottom:.25rem}.status-success[_ngcontent-%COMP%]   .status-text[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{font-size:.8125rem;color:#047857}.upload-error[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;padding:1rem;background:#fef2f2;border:1px solid #fecaca;border-radius:8px}.upload-error[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:20px;height:20px;color:#ef4444}.upload-error[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:.875rem;color:#991b1b}.reconcile-results[_ngcontent-%COMP%]{margin-top:1rem}.result-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr);gap:1rem}@media (max-width: 768px){.result-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}.result-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;padding:1.25rem;background:#f9fafb;border:1px solid #e5e7eb;border-radius:8px}.result-item.existing[_ngcontent-%COMP%]{background:#ecfdf5;border-color:#a7f3d0}.result-item.new[_ngcontent-%COMP%]{background:#eff6ff;border-color:#bfdbfe}.result-item.ignored[_ngcontent-%COMP%]{background:#fef3c7;border-color:#fde68a}.result-item[_ngcontent-%COMP%]   .result-icon[_ngcontent-%COMP%]{width:36px;height:36px;border-radius:50%;display:flex;align-items:center;justify-content:center;flex-shrink:0}.result-item[_ngcontent-%COMP%]   .result-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:18px;height:18px}.result-item.existing[_ngcontent-%COMP%]   .result-icon[_ngcontent-%COMP%]{background:#d1fae5}.result-item.existing[_ngcontent-%COMP%]   .result-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{color:#10b981}.result-item.new[_ngcontent-%COMP%]   .result-icon[_ngcontent-%COMP%]{background:#dbeafe}.result-item.new[_ngcontent-%COMP%]   .result-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{color:#3b82f6}.result-item.ignored[_ngcontent-%COMP%]   .result-icon[_ngcontent-%COMP%]{background:#fef3c7}.result-item.ignored[_ngcontent-%COMP%]   .result-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{color:#f59e0b}.result-item[_ngcontent-%COMP%]   .result-content[_ngcontent-%COMP%]{flex:1}.result-item[_ngcontent-%COMP%]   .result-count[_ngcontent-%COMP%]{font-size:1.375rem;font-weight:700;color:#111827;line-height:1}.result-item[_ngcontent-%COMP%]   .result-label[_ngcontent-%COMP%]{font-size:.8125rem;color:#6b7280;margin-top:.25rem}.input-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.input-label[_ngcontent-%COMP%]{font-size:.875rem;font-weight:500;color:#374151;display:block;margin-bottom:.25rem}.input-label[_ngcontent-%COMP%]   .required[_ngcontent-%COMP%]{color:#ef4444}.input-wrapper[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center}.text-input[_ngcontent-%COMP%]{width:100%;padding:.75rem 3rem .75rem 1rem;background:#fff;border:1px solid #d1d5db;border-radius:6px;font-size:.9375rem;color:#111827;outline:none;transition:all .2s ease}.text-input[_ngcontent-%COMP%]::placeholder{color:#9ca3af}.text-input[_ngcontent-%COMP%]:focus{border-color:#8b5cf6;box-shadow:0 0 0 3px #8b5cf61a}.char-count[_ngcontent-%COMP%]{position:absolute;right:1rem;font-size:.75rem;color:#9ca3af;pointer-events:none}.input-hint[_ngcontent-%COMP%]{font-size:.8125rem;color:#6b7280;margin-top:.25rem}.input-error[_ngcontent-%COMP%]{font-size:.8125rem;color:#ef4444;margin-top:.25rem}.schedule-preview[_ngcontent-%COMP%]{padding:1.25rem;background:#f9fafb;border:1px solid #e5e7eb;border-radius:8px}.preview-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;margin-bottom:1.5rem;padding-bottom:1rem;border-bottom:2px solid #e5e7eb}.preview-header[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:20px;height:20px;color:#667eea}.preview-header[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:1rem;font-weight:700;color:#1e293b}.schedule-summary-box[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}.schedule-summary-box[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]{display:flex;gap:1.25rem;padding:1.25rem;background:#fff;border:2px solid #e5e7eb;border-radius:12px;transition:all .2s ease}.schedule-summary-box[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]:hover{border-color:#667eea;box-shadow:0 4px 12px #667eea1a}.schedule-summary-box[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-count[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;min-width:80px;padding:.75rem;background:linear-gradient(135deg,#667eea,#764ba2);border-radius:8px}.schedule-summary-box[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-count[_ngcontent-%COMP%]   .count-badge[_ngcontent-%COMP%]{font-size:1.75rem;font-weight:800;color:#fff;line-height:1}.schedule-summary-box[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-count[_ngcontent-%COMP%]   .count-label[_ngcontent-%COMP%]{font-size:.75rem;font-weight:600;color:#ffffffe6;margin-top:.25rem;text-transform:uppercase;letter-spacing:.5px}.schedule-summary-box[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-details[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;gap:.5rem;justify-content:center}.schedule-summary-box[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-details[_ngcontent-%COMP%]   .summary-time[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.schedule-summary-box[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-details[_ngcontent-%COMP%]   .summary-time[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{width:20px;height:20px;font-size:20px;color:#667eea}.schedule-summary-box[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-details[_ngcontent-%COMP%]   .summary-time[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-size:1.125rem;font-weight:700;color:#1e293b}.schedule-summary-box[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-details[_ngcontent-%COMP%]   .summary-time.immediate[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#f59e0b}.schedule-summary-box[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-details[_ngcontent-%COMP%]   .summary-time.immediate[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#f59e0b}.schedule-summary-box[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-details[_ngcontent-%COMP%]   .summary-timezone[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;font-size:.875rem;color:#64748b}.schedule-summary-box[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-details[_ngcontent-%COMP%]   .summary-timezone[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{width:16px;height:16px;font-size:16px;color:#94a3b8}.schedule-summary-box[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-details[_ngcontent-%COMP%]   .summary-timezone[_ngcontent-%COMP%]   .timezone-badge[_ngcontent-%COMP%]{padding:.25rem .625rem;background:#ede9fe;color:#7c3aed;border-radius:12px;font-size:.75rem;font-weight:600;margin-left:.5rem}.schedule-summary-box[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-details[_ngcontent-%COMP%]   .summary-timezone[_ngcontent-%COMP%]   .timezone-badge.local[_ngcontent-%COMP%]{background:#fef3c7;color:#d97706}.schedule-summary-box[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-details[_ngcontent-%COMP%]   .summary-timezone.warning[_ngcontent-%COMP%]{color:#d97706}.schedule-summary-box[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-details[_ngcontent-%COMP%]   .summary-timezone.warning[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#f59e0b}.schedule-summary-box[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-details[_ngcontent-%COMP%]   .summary-note[_ngcontent-%COMP%]{font-size:.8125rem;color:#64748b;font-style:italic}.schedule-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.625rem}.schedule-item[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:.625rem 1rem;background:#fff;border:1px solid #e5e7eb;border-radius:6px}.schedule-item[_ngcontent-%COMP%]   .schedule-time[_ngcontent-%COMP%]{font-size:.8125rem;color:#111827;font-weight:500}.schedule-item[_ngcontent-%COMP%]   .schedule-count[_ngcontent-%COMP%]{font-size:.8125rem;color:#6b7280}.schedule-more[_ngcontent-%COMP%]{padding:.5rem;text-align:center;font-size:.8125rem;color:#6b7280;font-style:italic}.test-email-section[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.25rem}.test-emails-preview[_ngcontent-%COMP%]{padding:1rem;background:#f9fafb;border:1px solid #e5e7eb;border-radius:8px;max-height:300px;overflow-y:auto}.test-emails-preview[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.test-emails-preview[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#0000000d;border-radius:3px}.test-emails-preview[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#6d28d94d;border-radius:3px}.test-emails-preview[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#6d28d980}.test-emails-preview[_ngcontent-%COMP%]   .preview-label[_ngcontent-%COMP%]{font-size:.875rem;font-weight:500;color:#374151;margin-bottom:.75rem;position:sticky;top:0;background:#f9fafb;z-index:1;padding-bottom:.5rem}.email-chips[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:.5rem}.email-chip[_ngcontent-%COMP%]{padding:.375rem .75rem;background:#fff;border:1px solid #e5e7eb;border-radius:6px;font-size:.8125rem;color:#374151;font-weight:500}.email-chip.more[_ngcontent-%COMP%]{font-style:italic;color:#6b7280}.test-email-btn[_ngcontent-%COMP%]{width:100%;background:#3b82f6!important;color:#fff!important;border:none!important;font-weight:600!important;padding:.875rem 1.5rem!important;border-radius:8px!important;display:flex!important;align-items:center!important;justify-content:center!important;transition:all .2s ease!important;box-shadow:0 2px 4px #3b82f633!important}.test-email-btn[_ngcontent-%COMP%]   .button-content[_ngcontent-%COMP%]{display:flex!important;flex-direction:row!important;align-items:center!important;justify-content:center!important;gap:.625rem!important;width:100%}.test-email-btn[_ngcontent-%COMP%]     .mat-button-wrapper{display:flex!important;flex-direction:row!important;align-items:center!important;justify-content:center!important;width:100%}.test-email-btn[_ngcontent-%COMP%]   mat-progress-spinner[_ngcontent-%COMP%]{flex-shrink:0}.test-email-btn[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:18px;height:18px;flex-shrink:0}.test-email-btn[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{white-space:nowrap}.test-email-btn[_ngcontent-%COMP%]:hover:not(:disabled){background:#2563eb!important;box-shadow:0 4px 8px #3b82f640!important;transform:translateY(-1px)}.test-email-btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.test-status[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.625rem;padding:.75rem 1rem;background:#ecfdf5;border:1px solid #a7f3d0;border-radius:6px}.test-status[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:18px;height:18px;color:#10b981}.test-status[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.8125rem;color:#065f46;font-weight:500}.submit-section[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}.submission-summary-banner[_ngcontent-%COMP%]{background:linear-gradient(135deg,#fef3c7,#fde68a);border:2px solid #fbbf24;border-radius:12px;padding:1.5rem;box-shadow:0 4px 12px #fbbf2433}.submission-summary-banner[_ngcontent-%COMP%]   .summary-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;margin-bottom:1rem;padding-bottom:.75rem;border-bottom:1px solid rgba(146,64,14,.2)}.submission-summary-banner[_ngcontent-%COMP%]   .summary-header[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:24px;height:24px;color:#f59e0b;flex-shrink:0}.submission-summary-banner[_ngcontent-%COMP%]   .summary-header[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0;font-size:1rem;font-weight:700;color:#92400e;letter-spacing:.025em}.submission-summary-banner[_ngcontent-%COMP%]   .summary-list[_ngcontent-%COMP%]{list-style:none;margin:0;padding:0;display:flex;flex-direction:column;gap:.75rem}.submission-summary-banner[_ngcontent-%COMP%]   .summary-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:.75rem;padding:.75rem;background:#fff9;border-radius:8px;transition:all .2s ease}.submission-summary-banner[_ngcontent-%COMP%]   .summary-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:hover{background:#ffffffe6;transform:translate(4px)}.submission-summary-banner[_ngcontent-%COMP%]   .summary-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .item-icon[_ngcontent-%COMP%]{font-size:1.25rem;flex-shrink:0;line-height:1}.submission-summary-banner[_ngcontent-%COMP%]   .summary-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .item-text[_ngcontent-%COMP%]{flex:1;font-size:.9375rem;color:#78350f;line-height:1.5;font-weight:500}.submission-summary-banner[_ngcontent-%COMP%]   .summary-list[_ngcontent-%COMP%]   li.summary-item-immediate[_ngcontent-%COMP%]{border-left:3px solid #ef4444}.submission-summary-banner[_ngcontent-%COMP%]   .summary-list[_ngcontent-%COMP%]   li.summary-item-timezone[_ngcontent-%COMP%]{border-left:3px solid #3b82f6}.submission-summary-banner[_ngcontent-%COMP%]   .summary-list[_ngcontent-%COMP%]   li.summary-item-member[_ngcontent-%COMP%]{border-left:3px solid #8b5cf6}.submission-summary-banner[_ngcontent-%COMP%]   .summary-list[_ngcontent-%COMP%]   li.summary-item-warning[_ngcontent-%COMP%]{border-left:3px solid #f59e0b}.submission-summary-banner[_ngcontent-%COMP%]   .summary-footer[_ngcontent-%COMP%]{margin:1rem 0 0;padding-top:1rem;border-top:1px solid rgba(146,64,14,.2);text-align:center;font-size:1rem;color:#92400e}.submission-summary-banner[_ngcontent-%COMP%]   .summary-footer[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-weight:700}@media (max-width: 768px){.submission-summary-banner[_ngcontent-%COMP%]{padding:1.25rem}.submission-summary-banner[_ngcontent-%COMP%]   .summary-header[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:20px;height:20px}.submission-summary-banner[_ngcontent-%COMP%]   .summary-header[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:.9375rem}.submission-summary-banner[_ngcontent-%COMP%]   .summary-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{padding:.625rem}.submission-summary-banner[_ngcontent-%COMP%]   .summary-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .item-icon[_ngcontent-%COMP%]{font-size:1.125rem}.submission-summary-banner[_ngcontent-%COMP%]   .summary-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .item-text[_ngcontent-%COMP%]{font-size:.875rem}.submission-summary-banner[_ngcontent-%COMP%]   .summary-footer[_ngcontent-%COMP%]{font-size:.9375rem}}.submit-btn[_ngcontent-%COMP%]{width:100%;background:#8b5cf6!important;color:#fff!important;border:none!important;font-weight:700!important;font-size:1rem!important;padding:1rem 2rem!important;border-radius:8px!important;display:flex!important;flex-direction:row!important;align-items:center!important;justify-content:center!important;gap:.75rem!important;box-shadow:0 4px 12px #8b5cf64d!important;transition:all .2s ease!important}.submit-btn[_ngcontent-%COMP%]   .button-content[_ngcontent-%COMP%]{display:flex!important;flex-direction:row!important;align-items:center!important;justify-content:center!important;gap:.75rem!important;width:100%}.submit-btn[_ngcontent-%COMP%]     .mat-button-wrapper{display:flex!important;flex-direction:row!important;align-items:center!important;justify-content:center!important;gap:.75rem!important;width:100%}.submit-btn[_ngcontent-%COMP%]   mat-progress-spinner[_ngcontent-%COMP%]{flex-shrink:0}.submit-btn[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:20px;height:20px;flex-shrink:0}.submit-btn[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{white-space:nowrap}.submit-btn[_ngcontent-%COMP%]:hover:not(:disabled){background:#7c3aed!important;box-shadow:0 6px 16px #8b5cf666!important;transform:translateY(-2px)}.submit-btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}@media (max-width: 768px){.submit-btn[_ngcontent-%COMP%]{padding:.875rem 1.5rem!important;font-size:.9375rem!important}}.warning-banner[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;gap:.75rem;padding:1rem;background:#fef3c7;border:1px solid #fde68a;border-radius:8px;text-align:center}.warning-banner[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:20px;height:20px;color:#f59e0b;flex-shrink:0;min-width:20px}.warning-banner[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.875rem;color:#92400e;flex:1;line-height:1.4}@media (max-width: 768px){.warning-banner[_ngcontent-%COMP%]{padding:.625rem .875rem;gap:.625rem}.warning-banner[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:18px;height:18px;min-width:18px}.warning-banner[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.8125rem}}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:2.5rem 2rem;color:#9ca3af}.empty-state[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:40px;height:40px;margin-bottom:1rem;opacity:.5}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:.9375rem;font-weight:500;color:#6b7280}.empty-state[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{display:block;margin-top:.5rem;font-size:.8125rem;color:#9ca3af}.timezone-info-banner[_ngcontent-%COMP%]{margin-bottom:1rem}.timezone-warning[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:.75rem;padding:.875rem 1rem;background:#fbbf241a;border:1px solid rgba(251,191,36,.3);border-radius:8px}.timezone-warning[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:20px;height:20px;color:#f59e0b;flex-shrink:0;min-width:20px;margin-top:2px}.timezone-warning[_ngcontent-%COMP%]   .warning-content[_ngcontent-%COMP%]{flex:1}.timezone-warning[_ngcontent-%COMP%]   .warning-content[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{display:block;font-size:.9rem;font-weight:700;margin-bottom:.25rem}.timezone-warning[_ngcontent-%COMP%]   .warning-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:.85rem;line-height:1.4}.timezone-info[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:.75rem;padding:.875rem 1rem;background:#3b82f61a;border:1px solid rgba(59,130,246,.3);border-radius:8px}.timezone-info[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:20px;height:20px;color:#3b82f6;flex-shrink:0;min-width:20px;margin-top:2px}.timezone-info[_ngcontent-%COMP%]   .info-content[_ngcontent-%COMP%]{flex:1}.timezone-info[_ngcontent-%COMP%]   .info-content[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{display:block;color:#393f52!important;font-size:.9rem;font-weight:700;margin-bottom:.25rem}.timezone-info[_ngcontent-%COMP%]   .info-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:.85rem;color:#393f52!important;line-height:1.4}.immediate-warning[_ngcontent-%COMP%]{display:flex;gap:.75rem;padding:.875rem 1rem;background:#fef2f2;border:1px solid #fecaca;border-radius:8px;margin-bottom:1rem}.immediate-warning[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:20px;height:20px;color:#dc2626;flex-shrink:0;margin-top:2px}.immediate-warning[_ngcontent-%COMP%]   .warning-text[_ngcontent-%COMP%]{flex:1}.immediate-warning[_ngcontent-%COMP%]   .warning-text[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{display:block;color:#991b1b;font-size:.9rem;margin-bottom:.25rem;font-weight:600}.immediate-warning[_ngcontent-%COMP%]   .warning-text[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:.85rem;color:#7f1d1d!important;line-height:1.4}.immediate-warning[_ngcontent-%COMP%]   .warning-text[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{display:inline;color:#fca5a5!important}.schedule-item.immediate[_ngcontent-%COMP%]{background:#ef44441a;border-left:3px solid #ef4444}.schedule-item.immediate[_ngcontent-%COMP%]   .schedule-time[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;color:#f87171}.schedule-item.immediate[_ngcontent-%COMP%]   .schedule-time[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:16px;height:16px}.schedule-item.local-timezone[_ngcontent-%COMP%]{border-left:3px solid #f59e0b}.time-with-zone[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.25rem}.time-with-zone[_ngcontent-%COMP%]   .time[_ngcontent-%COMP%]{font-weight:500;font-size:.9rem}.time-with-zone[_ngcontent-%COMP%]   .zone[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.35rem;font-size:.75rem;color:#fff9}.time-with-zone[_ngcontent-%COMP%]   .zone[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:12px;height:12px}.time-with-zone[_ngcontent-%COMP%]   .zone.local-indicator[_ngcontent-%COMP%]{color:#fbbf24;font-weight:500}@media (max-width: 768px){.timezone-warning[_ngcontent-%COMP%], .timezone-info[_ngcontent-%COMP%], .immediate-warning[_ngcontent-%COMP%]{flex-direction:column;gap:.5rem}.timezone-warning[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%], .timezone-info[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%], .immediate-warning[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{margin-top:0}.time-with-zone[_ngcontent-%COMP%]   .zone[_ngcontent-%COMP%]{font-size:.7rem}}.schedule-list-container[_ngcontent-%COMP%]{max-height:400px;overflow-y:auto;border-radius:8px;border:1px solid rgba(255,255,255,.1)}.schedule-list-container[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px}.schedule-list-container[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#0003;border-radius:4px}.schedule-list-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#a855f780;border-radius:4px}.schedule-list-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#a855f7b3}.schedule-list[_ngcontent-%COMP%]{padding:.5rem}.no-test-emails-warning[_ngcontent-%COMP%]{display:flex;gap:.75rem;padding:1rem;background:#fef2f2;border:1px solid #fecaca;border-radius:8px;margin-bottom:1rem}.no-test-emails-warning[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:24px;height:24px;color:#dc2626;flex-shrink:0;margin-top:2px}.no-test-emails-warning[_ngcontent-%COMP%]   .warning-content[_ngcontent-%COMP%]{flex:1}.no-test-emails-warning[_ngcontent-%COMP%]   .warning-content[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{display:block;color:#991b1b;font-size:.95rem;margin-bottom:.5rem;font-weight:600}.no-test-emails-warning[_ngcontent-%COMP%]   .warning-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:.875rem;color:#7f1d1d;line-height:1.5}.no-test-emails-warning[_ngcontent-%COMP%]   .warning-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   code[_ngcontent-%COMP%]{background:#fee2e2;padding:.125rem .375rem;border-radius:4px;font-family:Courier New,monospace;font-size:.85em;color:#991b1b;color:#fbbf24}.test-email-btn.disabled[_ngcontent-%COMP%], .test-email-btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed;background:#6464644d!important}.test-email-btn.disabled[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%], .test-email-btn[_ngcontent-%COMP%]:disabled   svg[_ngcontent-%COMP%]{opacity:.5}.add-members-section[_ngcontent-%COMP%]{margin-top:1rem;padding:1rem;background:#3b82f61a;border:1px solid rgba(59,130,246,.3);border-radius:8px}.toggle-container[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem}.toggle-checkbox[_ngcontent-%COMP%]{width:20px;height:20px;cursor:pointer;accent-color:#3b82f6}.toggle-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;cursor:pointer;font-size:.95rem;color:#ffffffe6;-webkit-user-select:none;user-select:none}.toggle-label[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:18px;height:18px;color:#60a5fa}.toggle-label[_ngcontent-%COMP%]:hover{color:#fff}.toggle-hint[_ngcontent-%COMP%]{display:block;margin-top:.5rem;margin-left:2.25rem;font-size:.8rem;color:#fff9;font-style:italic}.warning-banner[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:.75rem 1rem;margin-top:.75rem;background:#fbbf241a;border:1px solid rgba(251,191,36,.3);border-radius:6px}.warning-banner[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:18px;height:18px;color:#fbbf24;flex-shrink:0}.warning-banner[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.875rem;color:#fbbf24;font-weight:500}.button-wrapper[_ngcontent-%COMP%]{display:inline-block;width:100%}.subject-generator-section[_ngcontent-%COMP%]{padding:1.5rem;background:linear-gradient(135deg,#8b5cf614,#ec489914);border:1px solid rgba(139,92,246,.2);border-radius:12px;position:relative;overflow:hidden}.subject-generator-section[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:0;right:0;height:3px;background:linear-gradient(90deg,#8b5cf6,#ec4899);border-radius:3px 3px 0 0}@media (max-width: 768px){.subject-generator-section[_ngcontent-%COMP%]{padding:1.25rem;margin-bottom:1.25rem}}@media (max-width: 480px){.subject-generator-section[_ngcontent-%COMP%]{padding:1rem;margin-bottom:1rem}}.generator-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;gap:1.5rem;margin-bottom:1.25rem;flex-wrap:wrap}@media (max-width: 768px){.generator-header[_ngcontent-%COMP%]{gap:1rem;margin-bottom:1rem}}.generator-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;flex:1;min-width:0}@media (max-width: 480px){.generator-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]{gap:.75rem}}.generator-header[_ngcontent-%COMP%]   .icon-wrapper[_ngcontent-%COMP%]{width:44px;height:44px;background:linear-gradient(135deg,#8b5cf6,#ec4899);border-radius:10px;display:flex;align-items:center;justify-content:center;flex-shrink:0;box-shadow:0 4px 12px #8b5cf640}@media (max-width: 768px){.generator-header[_ngcontent-%COMP%]   .icon-wrapper[_ngcontent-%COMP%]{width:36px;height:36px}}.generator-header[_ngcontent-%COMP%]   .icon-wrapper[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:22px;height:22px;color:#fff}@media (max-width: 768px){.generator-header[_ngcontent-%COMP%]   .icon-wrapper[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:18px;height:18px}}.generator-header[_ngcontent-%COMP%]   .header-text[_ngcontent-%COMP%]{flex:1;min-width:0}.generator-header[_ngcontent-%COMP%]   .header-text[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 .25rem;font-size:1rem;font-weight:700;color:#1f2937}@media (max-width: 768px){.generator-header[_ngcontent-%COMP%]   .header-text[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:.9375rem}}@media (max-width: 480px){.generator-header[_ngcontent-%COMP%]   .header-text[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:.875rem}}.generator-header[_ngcontent-%COMP%]   .header-text[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:.8125rem;color:#6b7280}@media (max-width: 768px){.generator-header[_ngcontent-%COMP%]   .header-text[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.75rem}}@media (max-width: 480px){.generator-header[_ngcontent-%COMP%]   .header-text[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.6875rem}}.generate-subjects-btn[_ngcontent-%COMP%]{background:linear-gradient(135deg,#8b5cf6,#ec4899)!important;color:#fff!important;border:none!important;border-radius:8px!important;font-weight:600!important;font-size:.875rem!important;padding:.625rem 1.25rem!important;box-shadow:0 4px 12px #8b5cf640!important;display:inline-flex!important;flex-direction:row!important;align-items:center!important;justify-content:center!important;gap:.5rem!important;transition:all .2s ease!important;min-height:40px!important;white-space:nowrap!important;flex-shrink:0;cursor:pointer}@media (max-width: 768px){.generate-subjects-btn[_ngcontent-%COMP%]{font-size:.8125rem!important;padding:.5rem 1rem!important;min-height:36px!important}}@media (max-width: 480px){.generate-subjects-btn[_ngcontent-%COMP%]{font-size:.75rem!important;padding:.5rem .875rem!important;width:100%;justify-content:center!important}}.generate-subjects-btn[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:18px;height:18px;flex-shrink:0}@media (max-width: 768px){.generate-subjects-btn[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:16px;height:16px}}.generate-subjects-btn[_ngcontent-%COMP%]   mat-progress-spinner[_ngcontent-%COMP%]     circle{stroke:#fff!important}.generate-subjects-btn[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 6px 16px #8b5cf659!important}.generate-subjects-btn[_ngcontent-%COMP%]:active:not(:disabled){transform:translateY(0)}.generate-subjects-btn[_ngcontent-%COMP%]:disabled{opacity:.7;cursor:not-allowed;transform:none!important}.subjects-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:.875rem}@media (max-width: 768px){.subjects-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:.625rem}}.subject-chip[_ngcontent-%COMP%]{background:#fff;border:2px solid rgba(139,92,246,.15);border-radius:10px;padding:.875rem 1rem;cursor:pointer;transition:all .2s ease;display:flex;align-items:center;gap:.875rem}@media (max-width: 768px){.subject-chip[_ngcontent-%COMP%]{padding:.75rem .875rem}}.subject-chip[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:0;width:4px;height:100%;background:linear-gradient(135deg,#8b5cf6,#ec4899);opacity:0;transition:opacity .2s ease}.subject-chip[_ngcontent-%COMP%]:hover{border-color:#8b5cf666;box-shadow:0 4px 16px #8b5cf626;transform:translateY(-2px) scale(1.01)}.subject-chip[_ngcontent-%COMP%]:hover:before{opacity:1}.subject-chip[_ngcontent-%COMP%]:hover   .chip-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{transform:translate(3px)}.subject-chip[_ngcontent-%COMP%]:active{transform:translateY(-1px) scale(1)}.subject-chip.selected[_ngcontent-%COMP%]{background:linear-gradient(135deg,#8b5cf61a,#ec48991a);border-color:#8b5cf680}.subject-chip.selected[_ngcontent-%COMP%]:before{opacity:1}.subject-chip.selected[_ngcontent-%COMP%]   .chip-text[_ngcontent-%COMP%]{font-weight:600;color:#8b5cf6}.subject-chip.selected[_ngcontent-%COMP%]   .chip-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{color:#8b5cf6}.chip-content[_ngcontent-%COMP%]{flex:1;min-width:0;display:flex;flex-direction:column;gap:.25rem}.chip-text[_ngcontent-%COMP%]{font-size:.875rem;font-weight:500;color:#1f2937;line-height:1.4;word-break:break-word}@media (max-width: 768px){.chip-text[_ngcontent-%COMP%]{font-size:.8125rem}}.chip-length[_ngcontent-%COMP%]{font-size:.6875rem;color:#9ca3af;font-weight:600;font-family:SF Mono,Monaco,Cascadia Code,monospace}@media (max-width: 768px){.chip-length[_ngcontent-%COMP%]{font-size:.625rem}}.chip-icon[_ngcontent-%COMP%]{flex-shrink:0;width:28px;height:28px;background:#8b5cf614;border-radius:6px;display:flex;align-items:center;justify-content:center;transition:all .2s ease}@media (max-width: 768px){.chip-icon[_ngcontent-%COMP%]{width:24px;height:24px}}.chip-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:16px;height:16px;color:#9ca3af;transition:all .2s ease}@media (max-width: 768px){.chip-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:14px;height:14px}}.empty-subjects[_ngcontent-%COMP%]{grid-column:1/-1;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:2.5rem 1rem;gap:.875rem}@media (max-width: 768px){.empty-subjects[_ngcontent-%COMP%]{padding:2rem 1rem}}.empty-subjects[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:56px;height:56px;color:#d1d5db}@media (max-width: 768px){.empty-subjects[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:44px;height:44px}}.empty-subjects[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:.875rem;color:#9ca3af;text-align:center}@media (max-width: 768px){.empty-subjects[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.8125rem}}@media (max-width: 480px){.generator-header[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch}.generator-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%], .generator-header[_ngcontent-%COMP%]   .generate-subjects-btn[_ngcontent-%COMP%]{width:100%}.subjects-grid[_ngcontent-%COMP%]{gap:.5rem}}.subjects-loading[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:2rem;gap:1rem}.subjects-loading[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--text-secondary);font-size:.875rem;margin:0}'],changeDetection:0})}}return i})();var sa=(()=>{class i{constructor(){this.route=A(ce),this.router=A(le),this.location=A(We),this.qa=A(_e),this.destroy$=new re,this.templateHtml="",this.templateId="",this.runId="",this.no=""}ngOnInit(){this.templateId=this.route.snapshot.paramMap.get("id")||"",this.runId=this.route.snapshot.paramMap.get("runId")||"",this.no=this.route.snapshot.paramMap.get("no")||"";let o=this.router.getCurrentNavigation()?.extras?.state||history.state;o?.templateHtml?this.templateHtml=o.templateHtml:this.loadTemplateHtml()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}loadTemplateHtml(){!this.runId||!this.no||this.qa.getVariantsRunById(this.runId).then(e=>{if(e&&e.items&&e.items.length>0){let o=parseInt(this.no)-1;o>=0&&o<e.items.length&&(this.templateHtml=e.items[o].html)}}).catch(e=>{})}goBack(){this.location.back()}onCampaignClose(){this.router.navigate(["/qa",this.templateId,"use",this.runId,this.no])}static{this.\u0275fac=function(o){return new(o||i)}}static{this.\u0275cmp=V({type:i,selectors:[["app-campaign-setup-page"]],standalone:!0,features:[L],decls:14,vars:4,consts:[[1,"campaign-page"],[1,"campaign-header"],[1,"header-wrapper"],["aria-label","Go back",1,"back-btn",3,"click"],["width","20","height","20","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2.5"],["d","M19 12H5M12 19l-7-7 7-7"],[1,"header-title"],[1,"campaign-main"],[1,"campaign-container"],[3,"closeRequested","templateHtml","templateId","runId","variantNo"]],template:function(o,a){o&1&&(t(0,"div",0)(1,"header",1)(2,"div",2)(3,"button",3),_("click",function(){return a.goBack()}),C(),t(4,"svg",4),h(5,"path",5),n()(),v(),t(6,"div",6)(7,"h1"),r(8,"Campaign Setup"),n(),t(9,"p"),r(10,"Configure and schedule your email campaign"),n()()()(),t(11,"main",7)(12,"div",8)(13,"app-campaign-submit",9),_("closeRequested",function(){return a.onCampaignClose()}),n()()()()),o&2&&(s(13),l("templateHtml",a.templateHtml)("templateId",a.templateId)("runId",a.runId)("variantNo",a.no))},dependencies:[F,N,$,St],styles:[".campaign-page[_ngcontent-%COMP%]{min-height:100vh;background:linear-gradient(135deg,#667eea,#764ba2);position:relative}.campaign-header[_ngcontent-%COMP%]{position:sticky;top:0;z-index:1000;background:#fffffffa;-webkit-backdrop-filter:blur(20px);backdrop-filter:blur(20px);box-shadow:0 1px 3px #0000001a;border-bottom:1px solid rgba(102,126,234,.15)}.header-wrapper[_ngcontent-%COMP%]{max-width:1400px;margin:0 auto;padding:1.25rem 2rem;display:flex;align-items:center;gap:1.25rem}@media (max-width: 768px){.header-wrapper[_ngcontent-%COMP%]{padding:1rem 1.5rem;gap:1rem}}@media (max-width: 480px){.header-wrapper[_ngcontent-%COMP%]{padding:.875rem 1rem;gap:.875rem}}.back-btn[_ngcontent-%COMP%]{width:42px;height:42px;border-radius:10px;background:linear-gradient(135deg,#667eea,#764ba2);border:none;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .2s ease;flex-shrink:0;box-shadow:0 2px 8px #667eea4d}.back-btn[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{stroke:#fff}.back-btn[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 12px #667eea66}.back-btn[_ngcontent-%COMP%]:active{transform:translateY(0)}@media (max-width: 768px){.back-btn[_ngcontent-%COMP%]{width:38px;height:38px}}.header-title[_ngcontent-%COMP%]{flex:1}.header-title[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;font-size:1.75rem;font-weight:700;background:linear-gradient(135deg,#667eea,#764ba2);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;line-height:1.2}@media (max-width: 768px){.header-title[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.5rem}}@media (max-width: 480px){.header-title[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.25rem}}.header-title[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:.25rem 0 0;font-size:.9375rem;color:#64748b;font-weight:400}@media (max-width: 768px){.header-title[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.875rem}}@media (max-width: 480px){.header-title[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{display:none}}.campaign-main[_ngcontent-%COMP%]{padding:2.5rem 2rem}@media (max-width: 768px){.campaign-main[_ngcontent-%COMP%]{padding:2rem 1.5rem}}@media (max-width: 480px){.campaign-main[_ngcontent-%COMP%]{padding:1.5rem 1rem}}@media (max-height: 600px) and (orientation: landscape){.campaign-main[_ngcontent-%COMP%]{padding:1.5rem 1rem}}.campaign-container[_ngcontent-%COMP%]{max-width:1400px;margin:0 auto}  app-campaign-submit{display:block}  app-campaign-submit .campaign-submit-wrapper{padding:0!important;max-height:none!important;overflow:visible!important;gap:2rem!important}@media (max-width: 768px){  app-campaign-submit .campaign-submit-wrapper{gap:1.5rem!important}}  app-campaign-submit .section-card{background:#fffffff7!important;-webkit-backdrop-filter:blur(20px)!important;backdrop-filter:blur(20px)!important;border-radius:20px!important;padding:2.5rem!important;margin-bottom:2rem!important;border:1px solid rgba(255,255,255,.3)!important;box-shadow:0 10px 40px #00000014,0 2px 8px #0000000a!important;transition:all .3s cubic-bezier(.4,0,.2,1)!important}  app-campaign-submit .section-card:hover{transform:translateY(-2px);box-shadow:0 20px 50px #0000001a,0 4px 12px #0000000f!important}  app-campaign-submit .section-card:last-child{margin-bottom:0!important}@media (max-width: 768px){  app-campaign-submit .section-card{padding:2rem!important;border-radius:16px!important;margin-bottom:1.5rem!important}}@media (max-width: 480px){  app-campaign-submit .section-card{padding:1.5rem!important;border-radius:14px!important}}  app-campaign-submit .card-header{border-bottom:1px solid rgba(102,126,234,.1)!important}  app-campaign-submit .card-header h3{color:#1a202c!important;font-weight:600!important}  app-campaign-submit .card-header .header-icon{background:linear-gradient(135deg,#667eea1a,#764ba21a)!important}  app-campaign-submit .card-header .header-icon svg{color:#667eea!important}  app-campaign-submit input,   app-campaign-submit textarea,   app-campaign-submit select{border-color:#667eea33!important;transition:all .2s ease!important}  app-campaign-submit input:focus,   app-campaign-submit textarea:focus,   app-campaign-submit select:focus{border-color:#667eea!important;box-shadow:0 0 0 3px #667eea1a!important;outline:none!important}  app-campaign-submit button{transition:all .2s ease!important}  app-campaign-submit button:hover:not(:disabled){transform:translateY(-1px)}  app-campaign-submit button:active:not(:disabled){transform:translateY(0)}  app-campaign-submit .spinner-container{-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);background:#ffffffe6}@media (min-width: 769px) and (max-width: 1024px){.campaign-main[_ngcontent-%COMP%]{padding:2rem 1.5rem}}@media (max-height: 600px) and (orientation: landscape){.campaign-header[_ngcontent-%COMP%]{position:relative}.header-wrapper[_ngcontent-%COMP%]{padding:.75rem 1rem}.header-title[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.125rem}.campaign-main[_ngcontent-%COMP%]{padding:1rem}  app-campaign-submit .section-card{padding:1.25rem!important;margin-bottom:1rem!important}}@media (prefers-reduced-motion: reduce){*[_ngcontent-%COMP%]{animation:none!important;transition:none!important}}@media (prefers-contrast: high){.campaign-header[_ngcontent-%COMP%]{border-bottom:2px solid #667eea}  app-campaign-submit .section-card{border:2px solid rgba(102,126,234,.5)!important}}@media print{.campaign-header[_ngcontent-%COMP%]{position:static;box-shadow:none}.back-btn[_ngcontent-%COMP%]{display:none}  app-campaign-submit .section-card{box-shadow:none!important;page-break-inside:avoid}}"]})}}return i})();export{sa as CampaignSetupPageComponent};
